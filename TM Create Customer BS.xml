<?xml version="1.0" encoding="UTF-8"?><?Siebel-Property-Set EscapeNames="true"?><Business_spcService
 Comments="20170407:RAHUL: Retrofitted all changes related to Ent Code, Bill Cycle, Written Lang 20170112:RAHUL: Price List code change 20161213:RAHUL: Changes made for defect"
 State_spcManagement_spcType="Stateful"
 Cache="N"
 Server_spcEnabled="N"
 Display_spcName="TM Create Customer BS"
 Inactive="N"
 Hidden="N"
 Class="CSSService"
 Name="TM Create Customer BS"
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="1-HMVV9M"
 Display_spcName="CreateCA"
 Parent_spcName="TM Create Customer BS"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="CreateCA"
><Business_spcService_spcMethod_spcArg
 Preferred_spcSequence=""
 Data_spcType="String"
 Comments=""
 Parent_spcId="1-HMVV9N"
 Pick_spcApplet=""
 GParent_spcId="1-HMVV9M"
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="TM Create Customer BS"
 Pick_spcField=""
 Type="Input"
 Display_spcName="AccountName"
 Parent_spcName="CreateCA"
 Parent_spcInactive="N"
 Inactive="N"
 GParent_spcInactive="N"
 Picklist=""
 Hidden="N"
 Name="AccountName"
></Business_spcService_spcMethod_spcArg
><Business_spcService_spcMethod_spcArg
 Preferred_spcSequence=""
 Data_spcType="String"
 Comments=""
 Parent_spcId="1-HMVV9N"
 Pick_spcApplet=""
 GParent_spcId="1-HMVV9M"
 Optional="Y"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="TM Create Customer BS"
 Pick_spcField=""
 Type="Output"
 Display_spcName="ErrorCode"
 Parent_spcName="CreateCA"
 Parent_spcInactive="N"
 Inactive="N"
 GParent_spcInactive="N"
 Picklist=""
 Hidden="N"
 Name="ErrorCode"
></Business_spcService_spcMethod_spcArg
></Business_spcService_spcMethod
><Business_spcService_spcMethod
 Comments=""
 Parent_spcId="1-HMVV9M"
 Display_spcName="ReadCAF"
 Parent_spcName="TM Create Customer BS"
 Parent_spcInactive="N"
 Inactive="N"
 Hidden="N"
 Name="ReadCAF"
><Business_spcService_spcMethod_spcArg
 Preferred_spcSequence=""
 Data_spcType="String"
 Comments=""
 Parent_spcId="1-HMVV9Q"
 Pick_spcApplet=""
 GParent_spcId="1-HMVV9M"
 Optional="N"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="TM Create Customer BS"
 Pick_spcField=""
 Type="Input / Output"
 Display_spcName="Inputs"
 Parent_spcName="ReadCAF"
 Parent_spcInactive="N"
 Inactive="N"
 GParent_spcInactive="N"
 Picklist=""
 Hidden="N"
 Name="Inputs"
></Business_spcService_spcMethod_spcArg
><Business_spcService_spcMethod_spcArg
 Preferred_spcSequence=""
 Data_spcType="String"
 Comments=""
 Parent_spcId="1-HMVV9Q"
 Pick_spcApplet=""
 GParent_spcId="1-HMVV9M"
 Optional="N"
 Storage_spcType="Property"
 Integration_spcObject=""
 GParent_spcName="TM Create Customer BS"
 Pick_spcField=""
 Type="Input / Output"
 Display_spcName="Outputs"
 Parent_spcName="ReadCAF"
 Parent_spcInactive="N"
 Inactive="N"
 GParent_spcInactive="N"
 Picklist=""
 Hidden="N"
 Name="Outputs"
></Business_spcService_spcMethod_spcArg
></Business_spcService_spcMethod
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="1-HMVV9M"
 Parent_spcName="TM Create Customer BS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="//Your public declarations go here... _newline_newlinevar gvCAccId,gvAddId,gvSAccId,gvBAccId,gvConId,gvBPId,gvPPId,gvAddrType,gvCAFId,gvPrpdBillProf;_newlinevar strErrCode = &quot;&quot;;_newlinevar strErrMesg = &quot;&quot;;_newlinevar vEntCode = &quot;&quot;;"
 Program_spcLanguage="JS"
 Name="(declarations)"
 Sequence="1"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="1-HMVV9M"
 Parent_spcName="TM Create Customer BS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="//RAHUL: This code is used for Customer Creation. It reads CAF data from CAF table and based on that_newline//creates Customer Entities like CA, BA,SA, Address, Contact, Billing Profile and Payment Profiel_newline_newlinefunction Service_usPreInvokeMethod (MethodName, Inputs, Outputs)_newline{_newline var vCAFBo = TheApplication().GetBusObject(&quot;TM CAF Details BO&quot;);_newline var vCAFMstrBc = vCAFBo.GetBusComp(&quot;TM CAF Master BC&quot;);_newline var IsRec;_newline try_newline { _newline  vCAFMstrBc.ActivateField(&quot;Subscriber Type&quot;);_newline  vCAFMstrBc.ActivateField(&quot;CAF Id&quot;)_newline  vCAFMstrBc.ClearToQuery();_newline  vCAFMstrBc.SetViewMode(AllView);_newline  vCAFMstrBc.SetSearchSpec(&quot;CAF Id&quot;,Inputs.GetProperty(&quot;CAFId&quot;)); //Remove Comment on Server_newline  vCAFMstrBc.ExecuteQuery(ForwardOnly);_newline_newline  IsRec = vCAFMstrBc.FirstRecord();_newline  if(IsRec)_newline  {_newline   gvCAFId = vCAFMstrBc.GetFieldValue(&quot;CAF Id&quot;);_newline      //Outputs.SetProperty(&quot;RequestType&quot;,vCAFMstrBc.GetFieldValue(&quot;Request Type&quot;));_newline   Outputs.SetProperty(&quot;SubscriberType&quot;,vCAFMstrBc.GetFieldValue(&quot;Subscriber Type&quot;));_newline   if(MethodName == &quot;CreateCA&quot;) _newline   {  _newline    fun_usReadCAFAccount(Inputs, Outputs); _newline    //TheApplication().RaiseErrorText(&quot;ReadCAF&quot;);_newline    fun_usReadCAFContact(Inputs, Outputs);_newline    //TheApplication().RaiseErrorText(&quot;ReadCAFContact&quot;);_newline    fun_usReadCAFAddr(Inputs, Outputs);_newline    //TheApplication().RaiseErrorText(&quot;ReadCAFAddr&quot;);_newline    fun_usAssocEntity(Inputs, Outputs);_newline    //TheApplication().RaiseErrorText(&quot;AssocEntity&quot;);_newline    fun_usPrepaidBillProf(Inputs, Outputs);_newline    //heApplication().RaiseErrorText(&quot;PrepaidBillProf&quot;);_newline    return(CancelOperation); _newline   }_newline  }_newline } _newline catch(e)_newline {_newline  TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure&apos;,&apos;Service_usPreInvokeMethod&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline  throw e;_newline }_newline finally_newline {_newline  gvCAccId=null,_newline  gvAddId=null;_newline  gvSAccId=null;_newline  gvBAccId=null;_newline  gvConId=null;_newline  gvBPId=null;_newline  gvPPId=null;_newline  gvAddrType=null;_newline  gvCAFId=null;_newline  gvPrpdBillProf=null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="Service_usPreInvokeMethod"
 Sequence="16"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments="20161213:RAHUL: Changes made for defect 6568 to stamp correct Address Type"
 Parent_spcId="1-HMVV9M"
 Parent_spcName="TM Create Customer BS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="function fun_usAssocEntity(Inputs, Outputs)_newline{_newline var vCAFBo = TheApplication().GetBusObject(&quot;TM CAF Additional Info BO&quot;);_newline var vAddInfoBC = vCAFBo.GetBusComp(&quot;TM CAF Additional Info BC&quot;);_newline var vAccBO = TheApplication().GetBusObject(&quot;Account&quot;);_newline var vAccAddBC = vAccBO.GetBusComp(&quot;Account Address&quot;);_newline var vAccBC = vAccBO.GetBusComp(&quot;Account&quot;);_newline var vBAAccBO = TheApplication().GetBusObject(&quot;TM Billing Account&quot;);_newline var vBAccBC = vBAAccBO.GetBusComp(&quot;CUT Invoice Sub Accounts&quot;);_newline var vContAffBC = vAccBO.GetBusComp(&quot;Account Contact Affiliation&quot;);_newline var vConAffDtlBC = vAccBO.GetBusComp(&quot;Account Contact Affiliation Detail&quot;);_newline var vBAccAddBC = vBAAccBO.GetBusComp(&quot;Account Address&quot;); // 20161213:RAHUL: Added to associate Address to Billing Accoutnt: QC#6568_newline var vType,IsRec,vEntType,vAddLinkType,vAddReqRefId,vEntRefId,vCAFId,vContReqRefId,vSiebelAccId,vDoxId,vAddId,vContId,IsPre,IsAcc;_newline var vAssocAddBC,IsBundle,vStreetAddress,vCAccCon,vBAccCon,IsContact,IsCont, vRole, vAssocAddress;_newline var vAddType = &quot;&quot;;_newline try_newline {_newline  with(vAddInfoBC)_newline  {_newline   ActivateField(&quot;TM CAF Id&quot;);_newline   ActivateField(&quot;Type&quot;);_newline   ActivateField(&quot;Field01&quot;);_newline   ActivateField(&quot;Field02&quot;);_newline   ActivateField(&quot;Field03&quot;);_newline   ActivateField(&quot;Field05&quot;);_newline   ActivateField(&quot;Error Message&quot;);_newline   ActivateField(&quot;Status&quot;);_newline   ActivateField(&quot;Parent Id&quot;);_newline   SetViewMode(AllView);_newline   ClearToQuery();_newline   SetSearchSpec(&quot;TM CAF Id&quot;,gvCAFId);_newline   ExecuteQuery(ForwardOnly);_newline   var IsRecord = FirstRecord();_newline   while(IsRecord)_newline   {_newline    vType = GetFieldValue(&quot;Type&quot;);_newline    //TheApplication().Trace(&quot;vType:&quot;+vType);_newline    if(vType == &quot;Address Link&quot;)_newline    {_newline     vEntType = GetFieldValue(&quot;Field01&quot;);_newline     vAddLinkType = GetFieldValue(&quot;Field02&quot;);_newline     vAddReqRefId = GetFieldValue(&quot;Field03&quot;);_newline     vEntRefId = GetFieldValue(&quot;Field05&quot;);_newline     vCAFId = GetFieldValue(&quot;TM CAF Id&quot;);  _newline     Inputs.SetProperty(&quot;EntityType&quot;,vEntType);_newline     Inputs.SetProperty(&quot;EntRefId&quot;,vEntRefId);_newline     Inputs.SetProperty(&quot;AddReqRefId&quot;,vAddReqRefId);_newline     Inputs.SetProperty(&quot;CAFId&quot;,vCAFId);_newline     //vAddType = Outputs.GetProperty(&quot;AddressType&quot;);_newline     fun_usGetSiebelId(Inputs, Outputs);_newline     vAddType = Outputs.GetProperty(&quot;AddressType&quot;);_newline     vSiebelAccId=Outputs.GetProperty(&quot;SiebelID&quot;);_newline     vAddId=Outputs.GetProperty(&quot;Address_usId&quot;);  _newline     vStreetAddress=Outputs.GetProperty(&quot;StreetAddress&quot;);_newline     if(vEntType==&quot;Customer&quot; &amp;&amp; (vSiebelAccId != null || vSiebelAccId !=&quot;&quot; ) &amp;&amp; (vAddId != null || vAddId != &quot;&quot;))_newline     {_newline      //TheApplication().Trace(&quot;vCAFId :&quot;+vCAFId +&quot;vAddReqRefId:&quot;+vAddReqRefId+&quot;vEntRefId:&quot;+vEntRefId);_newline      //TheApplication().Trace(&quot;vAddType :&quot;+vAddType +&quot;vAddId:&quot;+vAddId+&quot;vSiebelAccId:&quot;+vSiebelAccId);  _newline      vAccBC.ActivateField(&quot;Street Address&quot;);_newline      vAccBC.ClearToQuery();_newline      vAccBC.SetViewMode(AllView);_newline      vAccBC.SetSearchSpec(&quot;Id&quot;,vSiebelAccId);_newline      vAccBC.ExecuteQuery(ForwardOnly);_newline      IsAcc=vAccBC.FirstRecord();_newline      if(IsAcc)_newline      {_newline       vAccAddBC.ActivateField(&quot;Account Id&quot;);_newline       vAccAddBC.ActivateField(&quot;Address Id&quot;);_newline       vAccAddBC.ActivateField(&quot;Address Link Type&quot;);_newline       vAccAddBC.ActivateField(&quot;TM Address Type&quot;);_newline       vAccAddBC.ActivateField(&quot;TM Address Type&quot;);_newline       vAccAddBC.ActivateField(&quot;TM POA Type&quot;);_newline       vAccAddBC.ActivateField(&quot;TM POA Number&quot;);_newline       vAccAddBC.ActivateField(&quot;TM POA Issue Date&quot;);_newline       vAccAddBC.ActivateField(&quot;TM POA Issue Place&quot;);_newline       vAccAddBC.ActivateField(&quot;TM POA Issue Auth&quot;);_newline       vAccAddBC.ActivateField(&quot;Address Link Type&quot;);_newline       vAccAddBC.SetViewMode(AllView);_newline       vAccAddBC.ClearToQuery();_newline       vAccAddBC.SetSearchSpec(&quot;Account Id&quot;,vSiebelAccId);_newline       vAccAddBC.SetSearchSpec(&quot;Address Id&quot;,vAddId);_newline       vAccAddBC.ExecuteQuery(ForwardOnly);_newline       IsRec = vAccAddBC.FirstRecord();_newline       //TheApplication().Trace(&quot;CustAdd:&quot;+IsRec);_newline/*If record is not found then associate the Address */_newline       if(!IsRec)_newline       {_newline        //vAccBC.ActivateField(&quot;Street Address&quot;);_newline        // vAccBC.ClearToQuery();_newline        //vAccBC.SetViewMode(AllView);_newline        //vAccBC.SetSearchSpec(&quot;Id&quot;,vSiebelAccId);_newline        //vAccBC.ExecuteQuery(ForwardOnly);     _newline        var vAssocAdd = vAccBC.GetMVGBusComp(&quot;Street Address&quot;).GetAssocBusComp();_newline        vAssocAdd.ClearToQuery();_newline        vAssocAdd.SetViewMode(AllView);_newline        vAssocAdd.SetSearchSpec(&quot;Id&quot;,vAddId);_newline        vAssocAdd.ExecuteQuery(ForwardOnly);_newline        if(vAssocAdd.FirstRecord())_newline        {_newline         try_newline         {_newline          vAssocAdd.Associate(NewBefore);_newline          vAccBC.WriteRecord();_newline          with(vAccAddBC)//  20160216: MBA- Added for defect 854_newline          {_newline           SetViewMode(AllView);_newline           ClearToQuery();_newline           SetSearchSpec(&quot;Account Id&quot;,vSiebelAccId);_newline           SetSearchSpec(&quot;Address Id&quot;,vAddId);_newline           ExecuteQuery(ForwardOnly);_newline           IsRec = FirstRecord();_newline           if(IsRec)_newline           {_newline            SetFieldValue(&quot;TM Address Type&quot;,vAddType);_newline            SetFieldValue(&quot;Address Link Type&quot;,vAddLinkType);_newline            SetFieldValue(&quot;TM POA Type&quot;,Outputs.GetProperty(&quot;POAType&quot;));_newline            SetFieldValue(&quot;TM POA Number&quot;,Outputs.GetProperty(&quot;POANumber&quot;));_newline            SetFieldValue(&quot;TM POA Issue Date&quot;,Outputs.GetProperty(&quot;POAIssueDate&quot;));_newline            SetFieldValue(&quot;TM POA Issue Place&quot;,Outputs.GetProperty(&quot;POAIssuePlace&quot;));_newline            SetFieldValue(&quot;TM POA Issue Auth&quot;,Outputs.GetProperty(&quot;POAIssueAuth&quot;));_newline            WriteRecord();_newline           }_newline          }//  20160216: MBA- Added for defect 854 - Till here_newline         }_newline         catch (e)_newline         {_newline          TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure&apos;,&apos;fun_usAsscoEntity:Account Address Association&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline         }_newline        }_newline       }//if(IsAcc)_newline       vAccBC.WriteRecord();_newline      }//if(IsRec)_newline_newline/* If address is present in Account Address BC, then query with Address Type, if record_newlinenot found then insert new record */_newline      else_newline      {_newline       vAccAddBC.SetViewMode(AllView);_newline       vAccAddBC.ClearToQuery();_newline       vAccAddBC.SetSearchSpec(&quot;Account Id&quot;,vSiebelAccId);_newline       vAccAddBC.SetSearchSpec(&quot;Address Id&quot;,vAddId);_newline       vAccAddBC.SetSearchSpec(&quot;TM Address Type&quot;,vAddType);_newline       vAccAddBC.ExecuteQuery(ForwardOnly);_newline       IsPre = vAccAddBC.FirstRecord();_newline       //TheApplication().Trace(&quot;AddExist IsPre:&quot;+IsPre);_newline       if(!IsPre)_newline       {_newline        vAccAddBC.NewRecord(NewAfter);_newline        vAccAddBC.SetFieldValue(&quot;TM Address Type&quot;,vAddType);_newline        vAccAddBC.SetFieldValue(&quot;Account Id&quot;,vSiebelAccId);_newline        vAccAddBC.SetFieldValue(&quot;Address Id&quot;,vAddId);_newline        vAccAddBC.SetFieldValue(&quot;Address Link Type&quot;,vAddLinkType);_newline        vAccAddBC.SetFieldValue(&quot;TM POA Type&quot;,Outputs.GetProperty(&quot;POAType&quot;));_newline        vAccAddBC.SetFieldValue(&quot;TM POA Number&quot;,Outputs.GetProperty(&quot;POANumber&quot;));_newline        vAccAddBC.SetFieldValue(&quot;TM POA Issue Date&quot;,Outputs.GetProperty(&quot;POAIssueDate&quot;));_newline        vAccAddBC.SetFieldValue(&quot;TM POA Issue Place&quot;,Outputs.GetProperty(&quot;POAIssuePlace&quot;));_newline        vAccAddBC.SetFieldValue(&quot;TM POA Issue Auth&quot;,Outputs.GetProperty(&quot;POAIssueAuth&quot;));_newline        vAccAddBC.WriteRecord();_newline        //Outputs.SetProperty(&quot;AddressId&quot;,vAccAddBC.GetFieldValue(&quot;Id&quot;));_newline       }// if(!IsPre)_newline      } //else_newline     }// vEntType==&quot;Customer&quot;_newline     if(vEntType==&quot;Account&quot; &amp;&amp; (vSiebelAccId !=&quot;&quot; ) &amp;&amp; (vAddId != &quot;&quot;))_newline     { _newline      //TheApplication().Trace(&quot;vCAFId :&quot;+vCAFId +&quot;vAddReqRefId:&quot;+vAddReqRefId+&quot;vEntRefId:&quot;+vEntRefId);_newline      //TheApplication().Trace(&quot;vAddType :&quot;+vAddType +&quot;vAddId:&quot;+vAddId+&quot;vSiebelAccId:&quot;+vSiebelAccId);_newline      vBAccBC.ActivateField(&quot;Street Address&quot;);_newline      vBAccBC.ClearToQuery();_newline      vBAccBC.SetViewMode(AllView);_newline      vBAccBC.SetSearchSpec(&quot;Id&quot;,vSiebelAccId);_newline      vBAccBC.ExecuteQuery(ForwardOnly);_newline      if(vBAccBC.CountRecords()&gt;0)_newline      {_newline       vBAccAddBC.ActivateField(&quot;Account Id&quot;);_newline       vBAccAddBC.ActivateField(&quot;Address Id&quot;);_newline       vBAccAddBC.ActivateField(&quot;Address Link Type&quot;);_newline       vBAccAddBC.ActivateField(&quot;TM Address Type&quot;);_newline       vBAccAddBC.ActivateField(&quot;TM Address Type&quot;);_newline       vBAccAddBC.ActivateField(&quot;TM POA Type&quot;);_newline       vBAccAddBC.ActivateField(&quot;TM POA Number&quot;);_newline       vBAccAddBC.ActivateField(&quot;TM POA Issue Date&quot;);_newline       vBAccAddBC.ActivateField(&quot;TM POA Issue Place&quot;);_newline       vBAccAddBC.ActivateField(&quot;TM POA Issue Auth&quot;);_newline       vBAccAddBC.ActivateField(&quot;Address Link Type&quot;); _newline       vBAccAddBC.SetViewMode(AllView);_newline       vBAccAddBC.ClearToQuery();_newline       vBAccAddBC.SetSearchSpec(&quot;Account Id&quot;,vSiebelAccId);_newline       vBAccAddBC.SetSearchSpec(&quot;Address Id&quot;,vAddId);_newline       vBAccAddBC.ExecuteQuery(ForwardOnly);_newline       IsRec = vBAccAddBC.FirstRecord();_newline       //TheApplication().Trace(&quot;BillAdd:&quot;+IsRec);_newline/* Check if address is already associated with Billing Account by querying in Account Address BC. If record is not found then associate the Address */_newline       if(!IsRec)_newline       {   _newline        vAssocAddress = vBAccBC.GetMVGBusComp(&quot;Street Address&quot;).GetAssocBusComp();_newline        vAssocAddress.ClearToQuery();_newline        vAssocAddress.SetViewMode(AllView);_newline        vAssocAddress.SetSearchSpec(&quot;Id&quot;,vAddId);_newline        vAssocAddress.ExecuteQuery(ForwardOnly);_newline        if(vAssocAddress.FirstRecord())_newline        {_newline         try_newline         {_newline          vAssocAddress.Associate(NewBefore);_newline          vBAccBC.WriteRecord();_newline          with(vBAccAddBC)//20161213:RAHUL: Changed BC name for QC#6568_newline          {_newline           SetViewMode(AllView);_newline           ClearToQuery();_newline           SetSearchSpec(&quot;Account Id&quot;,vSiebelAccId);_newline           SetSearchSpec(&quot;Address Id&quot;,vAddId);_newline           ExecuteQuery(ForwardOnly);_newline           IsRec = FirstRecord();_newline           if(IsRec)_newline           {_newline            SetFieldValue(&quot;TM Address Type&quot;,vAddType);_newline            SetFieldValue(&quot;Address Link Type&quot;,vAddLinkType);_newline            SetFieldValue(&quot;TM POA Type&quot;,Outputs.GetProperty(&quot;POAType&quot;));_newline            SetFieldValue(&quot;TM POA Number&quot;,Outputs.GetProperty(&quot;POANumber&quot;));_newline            SetFieldValue(&quot;TM POA Issue Date&quot;,Outputs.GetProperty(&quot;POAIssueDate&quot;));_newline            SetFieldValue(&quot;TM POA Issue Place&quot;,Outputs.GetProperty(&quot;POAIssuePlace&quot;));_newline            SetFieldValue(&quot;TM POA Issue Auth&quot;,Outputs.GetProperty(&quot;POAIssueAuth&quot;));_newline            WriteRecord();_newline           }_newline          }_newline         }_newline         catch (e)_newline         {_newline          TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure&apos;,&apos;fun_usAsscoEntity:Billing Account Address Association&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline         }_newline        }_newline       } //end if(!IsRec)_newline      } //end if(vBAccBC.CountRecords()&gt;0)_newline/* If address is present in Account Address BC, then query with Address Link type, if record_newlinenot found then insert new record */_newline      else_newline      {_newline       vBAccAddBC.SetViewMode(AllView);_newline       vBAccAddBC.ClearToQuery();_newline       vBAccAddBC.SetSearchSpec(&quot;Account Id&quot;,vSiebelAccId);_newline       vBAccAddBC.SetSearchSpec(&quot;Address Id&quot;,vAddId);_newline       vBAccAddBC.SetSearchSpec(&quot;TM Address Type&quot;,vAddType);_newline       vBAccAddBC.ExecuteQuery(ForwardOnly);_newline       IsPre = vBAccAddBC.FirstRecord();_newline       //TheApplication().Trace(&quot;BillAddExist:&quot;+IsPre);_newline       if(!IsPre)_newline       {_newline        vBAccAddBC.NewRecord(NewAfter);_newline        vBAccAddBC.SetFieldValue(&quot;Account Id&quot;,vSiebelAccId);_newline        vBAccAddBC.SetFieldValue(&quot;Address Id&quot;,vAddId);_newline        vBAccAddBC.SetFieldValue(&quot;TM Address Type&quot;,vAddType);_newline        vBAccAddBC.SetFieldValue(&quot;Address Link Type&quot;,vAddLinkType);_newline        vBAccAddBC.SetFieldValue(&quot;TM POA Type&quot;,Outputs.GetProperty(&quot;POAType&quot;));_newline        vBAccAddBC.SetFieldValue(&quot;TM POA Number&quot;,Outputs.GetProperty(&quot;POANumber&quot;));_newline        vBAccAddBC.SetFieldValue(&quot;TM POA Issue Date&quot;,Outputs.GetProperty(&quot;POAIssueDate&quot;));_newline        vBAccAddBC.SetFieldValue(&quot;TM POA Issue Place&quot;,Outputs.GetProperty(&quot;POAIssuePlace&quot;));_newline        vBAccAddBC.SetFieldValue(&quot;TM POA Issue Auth&quot;,Outputs.GetProperty(&quot;POAIssueAuth&quot;));_newline        vBAccAddBC.WriteRecord();_newline       }// if(!IsPre)_newline      }// end of else _newline     }// end Billing Account_newline     if(vEntType==&quot;BA&quot;)_newline      fun_usCreateBillProf(Inputs, Outputs);_newline    }// End of if(vType == &quot;Address Link&quot;)_newline// Associates Contacts with Cust &amp; Billing Account_newline    if(vType == &quot;Contact Link&quot;)_newline    {_newline     vEntType = GetFieldValue(&quot;Field01&quot;);_newline     vAddLinkType = GetFieldValue(&quot;Field02&quot;);_newline     vContReqRefId = GetFieldValue(&quot;Field03&quot;);_newline     vCAFId = GetFieldValue(&quot;TM CAF Id&quot;);_newline     vEntRefId = GetFieldValue(&quot;Field05&quot;);_newline     Inputs.SetProperty(&quot;EntityType&quot;,vEntType);_newline     Inputs.SetProperty(&quot;EntRefId&quot;,vEntRefId);_newline     Inputs.SetProperty(&quot;ContReqRefId&quot;,vContReqRefId);_newline     Inputs.SetProperty(&quot;CAFId&quot;,vCAFId);_newline     fun_usGetSiebelId(Inputs, Outputs);_newline     vSiebelAccId=Outputs.GetProperty(&quot;SiebelID&quot;);_newline     vContId=Outputs.GetProperty(&quot;Contact_usId&quot;);_newline     if(vEntType==&quot;Customer&quot; &amp;&amp; (vSiebelAccId !=&quot;&quot;) &amp;&amp; (vContId!=&quot;&quot;))_newline     {_newline      with(vAccBC)_newline      {_newline       ActivateField(&quot;Primary Contact Name&quot;);_newline       SetViewMode(AllView);_newline       ClearToQuery();_newline       SetSearchSpec(&quot;Id&quot;,vSiebelAccId);_newline       ExecuteQuery(ForwardOnly);_newline       IsContact=FirstRecord();_newline       if(IsContact)_newline       {_newline        vCAccCon = vAccBC.GetMVGBusComp(&quot;Primary Contact Name&quot;).GetAssocBusComp();_newline        with(vCAccCon)_newline        {_newline         ClearToQuery();_newline         SetViewMode(AllView);_newline         SetSearchSpec(&quot;Id&quot;,vContId);_newline         ExecuteQuery(ForwardOnly);_newline         if(FirstRecord())_newline         {_newline          try{Associate(NewBefore);}_newline          catch (e)_newline          {_newline           TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure&apos;,&apos;fun_usAsscoEntity:Cust Account Contact Association&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline          }_newline         }_newline        } // End of with(vCAccCon)_newline        WriteRecord();_newline       }// End of if(IsContact)_newline      }// End of with(vAccBC)_newline// To add Contact Role to Cust Acc_newline      vContAffBC.ActivateField(&quot;Account Id&quot;);_newline      vContAffBC.ClearToQuery();_newline      vContAffBC.SetViewMode(AllView);_newline      //vContAffBC.SetSearcSpec(&quot;[Account Id]=&apos;&quot;+vSiebelAccId+&quot;&apos;&quot;);_newline      vContAffBC.SetSearchSpec(&quot;Account Id&quot;,vSiebelAccId);_newline      vContAffBC.SetSearchSpec(&quot;Contact Id&quot;,vContId);_newline      vContAffBC.ExecuteQuery(ForwardOnly);_newline      if(vContAffBC.FirstRecord())_newline      {_newline       vRole = Outputs.GetProperty(&quot;ContactRole&quot;);_newline       if(vRole ==  &quot;&quot;) vRole = &quot;User&quot;;_newline       vConAffDtlBC.ActivateField(&quot;Role&quot;);_newline       vConAffDtlBC.ActivateField(&quot;Account Id&quot;);_newline       vConAffDtlBC.ActivateField(&quot;Contact Id&quot;);_newline       vConAffDtlBC.ClearToQuery();_newline       vConAffDtlBC.SetSearchExpr(&quot;[Role]=&apos;&quot;+vRole+&quot;&apos;&quot;);_newline       vConAffDtlBC.ExecuteQuery(ForwardOnly);_newline       if(!vConAffDtlBC.FirstRecord())_newline       {_newline        vConAffDtlBC.NewRecord(NewAfter);_newline        vConAffDtlBC.SetFieldValue(&quot;Role&quot;,vRole);_newline        vConAffDtlBC.WriteRecord(); _newline       }_newline      }// End of if(vContAffBC.FirstRecord())_newline     }// End of if(vEntType==&quot;Customer&quot; &amp;&amp; (vSiebelAccId != null || vSiebelAccId !=&quot;&quot;) &amp;&amp; (vContId!=null || vContId!=&quot;&quot;))_newline//Associate Contact role to Bill Acc _newline     if(vEntType==&quot;Account&quot; &amp;&amp; (vSiebelAccId !=&quot;&quot;) &amp;&amp; (vContId!=&quot;&quot;))_newline     {_newline      with(vBAccBC)_newline      {_newline       ActivateField(&quot;Primary Contact Last Name&quot;);_newline       SetViewMode(AllView);_newline       ClearToQuery();_newline       SetSearchSpec(&quot;Id&quot;,vSiebelAccId);_newline       ExecuteQuery(ForwardOnly);_newline       IsCont=FirstRecord();_newline       if(IsCont)_newline       {_newline        vBAccCon = vBAccBC.GetMVGBusComp(&quot;Primary Contact Last Name&quot;).GetAssocBusComp();_newline        with(vBAccCon)_newline        {_newline         ClearToQuery();_newline         SetViewMode(AllView);_newline         SetSearchSpec(&quot;Id&quot;,vContId);_newline         ExecuteQuery(ForwardOnly);_newline         if(FirstRecord())      _newline         {_newline          try{Associate(NewBefore);  }          _newline          catch (e)_newline          {_newline           TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure&apos;,&apos;fun_usAsscoEntity: Billing Account Contact Association&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline          }_newline         }_newline        }_newline        WriteRecord();_newline       }_newline      } _newline     } _newline    }// End  Contact Link_newline    IsRecord=NextRecord();_newline   }_newline  }_newline  return(CancelOperation);_newline }//try _newline catch(e)_newline {_newline  TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure&apos;,&apos;fun_usAsscoEntity&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline  throw e;_newline }_newline finally_newline {  _newline  vContAffBC =null;_newline  vConAffDtlBC = null;_newline  vAssocAddBC=null;_newline  vAssocAddress=null;_newline  vBAccBC=null;_newline  vAccBC=null;_newline  vAccAddBC=null;_newline  vBAccAddBC =null;_newline  vAddInfoBC=null;_newline  vBAAccBO=null;_newline  vAccBO=null;_newline  vCAFBo=null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="fun_usAssocEntity"
 Sequence="2"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments="20161111:RAHUL: QC#5168: Area Id stored at Address Level"
 Parent_spcId="1-HMVV9M"
 Parent_spcName="TM Create Customer BS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="//20151208:RAHUL: Function to create Address of type Permanent, Residential, Official and Alternate_newlinefunction fun_usCreateAddress(Inputs,Outputs)_newline{_newline var vAddLine1,vAddLine2,vAddLine3,vCity,vState,vCountry,vZipCode,vServiceRegion,vAddPre,vAddrId=&quot;&quot;, vSearchExp = &quot;&quot;;_newline var vAddBO = TheApplication().GetBusObject(&quot;Account&quot;);_newline var vAddBC = vAddBO.GetBusComp(&quot;CUT Address&quot;);_newline //var vAccAddBC = vAddBO.GetBusComp(&quot;Account Address&quot;);_newline try_newline {_newline  with(vAddBC)_newline  {_newline   SetViewMode(AllView);_newline   ActivateField(&quot;Street Address&quot;);_newline   ActivateField(&quot;Street Address&quot;);_newline   ActivateField(&quot;Street Address 2&quot;);_newline   ActivateField(&quot;Street Address 3&quot;);_newline   ActivateField(&quot;Street Address 4&quot;);_newline   ActivateField(&quot;City&quot;);_newline   ActivateField(&quot;State&quot;);_newline   ActivateField(&quot;Country&quot;);_newline   ActivateField(&quot;Postal Code&quot;);_newline   ActivateField(&quot;County&quot;);_newline   ActivateField(&quot;SyncDescription&quot;);_newline   ActivateField(&quot;Address Name&quot;);_newline   _newline   ClearToQuery();_newline   //SetSearchSpec(&quot;Street Address&quot;,&quot;\&quot;&quot; + Outputs.GetProperty(&quot;AddrLine1&quot;) + &quot;\&quot;&quot;);_newline   //SetSearchSpec(&quot;Street Address 2&quot;,&quot;\&quot;&quot; + Outputs.GetProperty(&quot;AddrLine2&quot;) + &quot;\&quot;&quot;);_newline   //SetSearchSpec(&quot;City&quot;,&quot;\&quot;&quot; + Outputs.GetProperty(&quot;City&quot;) + &quot;\&quot;&quot;);_newline   //SetSearchSpec(&quot;State&quot;,&quot;\&quot;&quot; + Outputs.GetProperty(&quot;State&quot;) + &quot;\&quot;&quot;);_newline   vAddLine1 = Outputs.GetProperty(&quot;AddrLine1&quot;);_newline   vAddLine2 = Outputs.GetProperty(&quot;AddrLine2&quot;);_newline   vCity = Outputs.GetProperty(&quot;City&quot;);_newline   vState = Outputs.GetProperty(&quot;State&quot;);_newline            vSearchExp = &quot;[Street Address]= &apos;&quot;+vAddLine1+&quot;&apos; AND [Street Address 2]=&apos;&quot;+vAddLine2+&quot;&apos; AND [City]=&apos;&quot;+vCity+&quot;&apos; AND [State]=&apos;&quot;+vState+&quot;&apos;&quot;;_newline   SetSearchExpr(vSearchExp);_newline   ExecuteQuery(ForwardOnly);_newline   var IsRec = FirstRecord();_newline// If Address doesnt exist, create New Address_newline   if(!IsRec)_newline   {_newline    NewRecord(NewAfter);_newline    SetFieldValue(&quot;Street Address&quot;,Outputs.GetProperty(&quot;AddrLine1&quot;));_newline    SetFieldValue(&quot;Street Address 2&quot;,Outputs.GetProperty(&quot;AddrLine2&quot;));_newline    SetFieldValue(&quot;Street Address 3&quot;,Outputs.GetProperty(&quot;AddrLine3&quot;));_newline    SetFieldValue(&quot;Street Address 4&quot;,Outputs.GetProperty(&quot;Landmark&quot;));_newline    SetFieldValue(&quot;City&quot;,Outputs.GetProperty(&quot;City&quot;));_newline    SetFieldValue(&quot;State&quot;,Outputs.GetProperty(&quot;State&quot;));_newline    SetFieldValue(&quot;Country&quot;,Outputs.GetProperty(&quot;Country&quot;));_newline    SetFieldValue(&quot;Postal Code&quot;,Outputs.GetProperty(&quot;ZipCode&quot;));_newline//20161008: Rahul: To store Cost Center Code_newline    SetFieldValue(&quot;County&quot;,Outputs.GetProperty(&quot;CostCenterCode&quot;));_newline//20161111:RAHUL: To store Area Id_newline    SetFieldValue(&quot;SyncDescription&quot;,Outputs.GetProperty(&quot;AreaId&quot;));_newline    SetFieldValue(&quot;Address Name&quot;,GetFieldValue(&quot;Id&quot;));_newline    WriteRecord();_newline    gvAddId = GetFieldValue(&quot;Id&quot;);_newline    Outputs.SetProperty(&quot;AddressId&quot;,GetFieldValue(&quot;Id&quot;));_newline    Outputs.SetProperty(&quot;StreetAddress&quot;, GetFieldValue(&quot;Street Address&quot;));_newline    Outputs.SetProperty(&quot;AddErrMsg&quot;,&quot;New Address Created&quot;);_newline   }_newline// If Address is Present: query if same Address with same Address Type is assciated with an Account_newline   else _newline   {_newline    Outputs.SetProperty(&quot;AddressId&quot;,GetFieldValue(&quot;Id&quot;));_newline    Outputs.SetProperty(&quot;StreetAddress&quot;, GetFieldValue(&quot;Street Address&quot;));_newline    Outputs.SetProperty(&quot;AddErrMsg&quot;,&quot;Existing Address Used&quot;);_newline    gvAddId = GetFieldValue(&quot;Id&quot;);_newline   }   _newline  } _newline  return(CancelOperation);_newline }_newline catch(e)_newline {_newline  TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure&apos;,&apos;fun_usCreateAddress&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline  throw e;_newline }_newline finally_newline { _newline  //vAccAddBC=null;_newline  vAddBC=null;_newline  vAddBO=null; _newline }_newline}"
 Program_spcLanguage="JS"
 Name="fun_usCreateAddress"
 Sequence="3"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="1-HMVV9M"
 Parent_spcName="TM Create Customer BS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="//20151206:RAHUL:Function to create Billing  Account_newlinefunction fun_usCreateBA(Inputs,Outputs)_newline{_newline var vAccName,vAccType,vGenCode,vAccStatus,vCircle,vLoc,vAddrId,vPriceList,PriceListBC;_newline var vDOXBAId,vCircleBC,vParentDoxId,vParentAccId,vMasterAccId,vSearchExpr = &quot;&quot;;_newline var vDOXCustType,vDOXCustSubType,vSearch = &quot;&quot;;_newline var vBAccBO = TheApplication().GetBusObject(&quot;Account&quot;);_newline var vBAccBC = vBAccBO.GetBusComp(&quot;CUT Invoice Sub Accounts&quot;);_newline try_newline {_newline  with(vBAccBC)_newline  {_newline   ActivateField(&quot;Name&quot;);_newline   ActivateField(&quot;Type&quot;);_newline   ActivateField(&quot;Location&quot;);_newline   ActivateField(&quot;Account Type Code&quot;);_newline   ActivateField(&quot;Market Class&quot;);_newline   ActivateField(&quot;Market Type&quot;);_newline   ActivateField(&quot;DUNS Number&quot;);_newline   ActivateField(&quot;TM Credit Limit&quot;);_newline   ActivateField(&quot;TM Credit Score&quot;);_newline   ActivateField(&quot;TM Credit Status&quot;);_newline   ActivateField(&quot;TM Market Potential&quot;);_newline   ActivateField(&quot;Parent Account Id&quot;);_newline   ActivateField(&quot;Master Account Id&quot;);_newline   ActivateField(&quot;TM Integration Id&quot;);_newline   ActivateField(&quot;Street Address&quot;);_newline   ActivateField(&quot;Primary Organization Id&quot;);_newline   ActivateField(&quot;Access Level&quot;);_newline   ActivateField(&quot;TM Credit Class&quot;);_newline   ActivateField(&quot;Fin Acct - Business Type&quot;);_newline   ActivateField(&quot;Ownership Type&quot;);_newline   //ActivateField(&quot;Credit Class&quot;);_newline   vDOXBAId = Outputs.GetProperty(&quot;FA_usId&quot;);_newline   ClearToQuery();_newline   SetViewMode(AllView);_newline   //SetSearchSpec(&quot;TM Integration Id&quot;,vDOXBAId);_newline   vSearchExpr = &quot;[TM Integration Id] = &apos;&quot; + vDOXBAId + &quot;&apos; &quot;;_newline   SetSearchExpr(vSearchExpr);_newline   ExecuteQuery(ForwardOnly);_newline   var IsRec = FirstRecord();_newline   if(!IsRec)_newline   {    _newline    NewRecord(NewAfter);       _newline    SetFieldValue(&quot;Name&quot;,Outputs.GetProperty(&quot;BA_usAccName&quot;));_newline    SetFieldValue(&quot;Account Type Code&quot;,&quot;Billing&quot;);_newline    // SetFieldValue(&quot;Alias&quot;,Outputs.GetProperty(&quot;BA_usEntCode&quot;));  _newline //20170315:RAHUL: Get Enterprise Code from Ent Code and Gen Code Matrix, QC#8954_newline    vGenCode = Outputs.GetProperty(&quot;GEN_usCODE&quot;);_newline    if (vGenCode != &quot;&quot;)_newline    {_newline     fun_usGetEntCode(Inputs, Outputs);  _newline     SetFieldValue(&quot;Alias&quot;,vEntCode);_newline    }_newline _newline    SetFieldValue(&quot;TM Credit Limit&quot;,Outputs.GetProperty(&quot;CreditLimit&quot;));_newline    SetFieldValue(&quot;TM Credit Score&quot;,Outputs.GetProperty(&quot;CreditScore&quot;));_newline    SetFieldValue(&quot;TM Credit Status&quot;,Outputs.GetProperty(&quot;CreditStatus&quot;));_newline    SetFieldValue(&quot;TM Integration Id&quot;,vDOXBAId); _newline   _newline // Below code is to derive Cust Type, Sub Type, Segment and Treatment Status using Dox Type/Sub Type values provided in CAF_newline    vDOXCustType = Outputs.GetProperty(&quot;BA_usCustType&quot;);_newline    vDOXCustSubType = Outputs.GetProperty(&quot;BA_usCustSubType&quot;);_newline    vSearch = vDOXCustType + &quot;:&quot; + vDOXCustSubType;_newline    if(vSearch != &quot;&quot;)_newline    {_newline     SetFieldValue(&quot;Type&quot;,TheApplication().EAILookup(&quot;Internal&quot;,&quot;TM_usCUST_usTYPE&quot;,vSearch));_newline     SetFieldValue(&quot;Market Class&quot;,TheApplication().EAILookup(&quot;Internal&quot;,&quot;TM_usCUST_usSUB_usTYPE&quot;,vSearch));_newline     SetFieldValue(&quot;Market Type&quot;,TheApplication().EAILookup(&quot;Internal&quot;,&quot;TM_usCUST_usSEGMENT&quot;,vSearch));_newline     SetFieldValue(&quot;Access Level&quot;,TheApplication().EAILookup(&quot;Internal&quot;,&quot;TM_usTREATMENT_usSTATUS&quot;,vSearch));_newline     SetFieldValue(&quot;TM Credit Class&quot;,TheApplication().EAILookup(&quot;Internal&quot;,&quot;TM_usCREDIT_usCLASS&quot;,vSearch));_newline     SetFieldValue(&quot;Ownership Type&quot;,TheApplication().EAILookup(&quot;Internal&quot;,&quot;TM_usVIL_usCUST_usTYPE&quot;,vSearch));_newline     SetFieldValue(&quot;Fin Acct - Business Type&quot;,TheApplication().EAILookup(&quot;Internal&quot;,&quot;TM_usVIL_usCUST_usSUB_usTYPE&quot;,vSearch));_newline     _newline     vParentDoxId = Outputs.GetProperty(&quot;ExtParentAccId&quot;);_newline     if(vParentDoxId != null &amp;&amp; vParentDoxId != &quot;&quot;)_newline     {_newline      fun_usGetParentAcc(Inputs, Outputs);_newline      vParentAccId = Outputs.GetProperty(&quot;ParentAccountId&quot;);_newline      vMasterAccId = Outputs.GetProperty(&quot;MasterAccountId&quot;);_newline      SetFieldValue(&quot;Parent Account Id&quot;,vParentAccId);_newline      SetFieldValue(&quot;Master Account Id&quot;,vMasterAccId);_newline     }_newline     else_newline     {_newline      SetFieldValue(&quot;Parent Account Id&quot;,Outputs.GetProperty(&quot;CAccId&quot;));_newline      SetFieldValue(&quot;Master Account Id&quot;,Outputs.GetProperty(&quot;MasterAccId&quot;))_newline     }    _newline    }// if(vSearch != &quot;&quot;)_newline // If Cust Type/Sub Type not provided on Billing Account level, get it from Parent Account_newline    else_newline    {_newline     vParentDoxId = Outputs.GetProperty(&quot;ExtParentAccId&quot;);_newline     if(vParentDoxId != null &amp;&amp; vParentDoxId != &quot;&quot;)_newline     {_newline      fun_usGetParentAcc(Inputs, Outputs);_newline      vParentAccId = Outputs.GetProperty(&quot;ParentAccountId&quot;);_newline      vMasterAccId = Outputs.GetProperty(&quot;MasterAccountId&quot;);_newline      SetFieldValue(&quot;Parent Account Id&quot;,vParentAccId);_newline      SetFieldValue(&quot;Master Account Id&quot;,vMasterAccId);_newline      SetFieldValue(&quot;Type&quot;, Outputs.GetProperty(&quot;ParentCustType&quot;));_newline      SetFieldValue(&quot;Market Class&quot;,Outputs.GetProperty(&quot;ParentCustSubType&quot;));_newline      SetFieldValue(&quot;Access Level&quot;,Outputs.GetProperty(&quot;ParentTreatStatus&quot;));_newline      SetFieldValue(&quot;Ownership Type&quot;,Outputs.GetProperty(&quot;VILCustType&quot;));_newline      SetFieldValue(&quot;Fin Acct - Business Type&quot;,Outputs.GetProperty(&quot;VILCustSubType&quot;));_newline      SetFieldValue(&quot;Access Level&quot;,Outputs.GetProperty(&quot;ParentTreatStatus&quot;));_newline     }// End of if(vParentDoxId != null || vParentDoxId != &quot;&quot;)_newline    }_newline     _newline // To set Circle to Billing Account_newline    vCircle = Outputs.GetProperty(&quot;Circle&quot;);_newline    vCircleBC = vBAccBC.GetMVGBusComp(&quot;Organization&quot;).GetAssocBusComp();_newline    with(vCircleBC)_newline    {_newline     ActivateField(&quot;Name&quot;);_newline     ClearToQuery();_newline     SetViewMode(AllView);_newline     // SetSearchSpec(&quot;Name&quot;,Outputs.GetProperty(&quot;Circle&quot;));_newline     vSearchExpr = &quot;[Name] = &apos;&quot; + vCircle + &quot;&apos; &quot;;_newline     SetSearchExpr(vSearchExpr);_newline     ExecuteQuery(ForwardOnly);_newline     if (FirstRecord())_newline     {_newline      try_newline      {_newline       Associate(NewBefore);_newline      }_newline      catch (e)_newline      {_newline         TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure:CircleAssociation&apos;,&apos;fun_usCreateBA&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline      }_newline     }_newline    }_newline    SetFieldValue(&quot;Primary Organization Id&quot;,vCircleBC.GetFieldValue(&quot;Id&quot;));_newline// Set Pricelist to Billing Account_newline    vCircle = Outputs.GetProperty(&quot;Circle&quot;);_newline    vPriceList = &quot;DefaultPriceList&quot; + &quot; &quot; + vCircle;_newline    PriceListBC = GetPicklistBusComp(&quot;Price List&quot;);_newline    with(PriceListBC)_newline    {_newline     ClearToQuery();_newline           SetViewMode(AllView);_newline           //SetSearchSpec(&quot;Name&quot;,vPriceList);_newline     SetSearchExpr(&quot;[Name] = &apos;&quot; + vPriceList + &quot;&apos; &quot;);_newline           ExecuteQuery(ForwardOnly);_newline           if (FirstRecord())_newline            Pick();_newline    }_newline_newline    WriteRecord();_newline    Outputs.SetProperty(&quot;BillAccId&quot;,GetFieldValue(&quot;Id&quot;));_newline    Outputs.SetProperty(&quot;ErrMsg&quot;,&quot;Billing Account Created&quot;);_newline    gvBAccId=GetFieldValue(&quot;Id&quot;);_newline   }_newline   else_newline   {_newline    Outputs.SetProperty(&quot;BillAccId&quot;,GetFieldValue(&quot;Id&quot;));_newline    //Outputs.SetProperty(&quot;ParentAccId&quot;,GetFieldValue(&quot;Parent Account Id&quot;))_newline    //Outputs.SetProperty(&quot;MasterAccId&quot;,GetFieldValue(&quot;Master Account Id&quot;));_newline    Outputs.SetProperty(&quot;ErrMsg&quot;,&quot;Billing Account already exist&quot;);_newline    gvBAccId = GetFieldValue(&quot;Id&quot;);_newline   }_newline  }_newline  return(CancelOperation);_newline }_newline catch(e)_newline {_newline  TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure&apos;,&apos;fun_usCreateBA&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline  throw e;_newline }_newline finally_newline {_newline  PriceListBC =null;_newline  vCircleBC=null;_newline  vBAccBC=null;_newline  vBAccBO=null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="fun_usCreateBA"
 Sequence="4"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="1-HMVV9M"
 Parent_spcName="TM Create Customer BS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="//This function creates Billing Profile and Payment Profile._newlinefunction fun_usCreateBillProf(Inputs,Outputs)_newline{_newline var vBillProfId,vBillType,vBil,IsRec,IsBillProf,IsPayProf,vPayMethod,bcPick;_newline var vBillProfBo = TheApplication().GetBusObject(&quot;Account&quot;);_newline var vBillProfBc = vBillProfBo.GetBusComp(&quot;Com Invoice Profile&quot;);_newline var vCAFBo = TheApplication().GetBusObject(&quot;TM CAF Details BO&quot;);_newline var vCAFAccBc = vCAFBo.GetBusComp(&quot;TM CAF Account Details BC&quot;);_newline var vEntType=Inputs.GetProperty(&quot;EntityType&quot;);_newline //var vRequestType = Outputs.GetProperty(&quot;RequestType&quot;);_newline var vRequestType = Outputs.GetProperty(&quot;SubscriberType&quot;);_newline try_newline { _newline  with(vBillProfBc)_newline  {_newline//To create Billing Profile under Billing Account_newline   ActivateField(&quot;Email Bill To&quot;);_newline   ActivateField(&quot;Payment Method&quot;);_newline   ActivateField(&quot;Payment Type&quot;);_newline   ActivateField(&quot;Bill Type&quot;);_newline   ActivateField(&quot;Bill Frequency&quot;);_newline   ActivateField(&quot;Media Type&quot;);_newline   ActivateField(&quot;TM Bill Language&quot;);_newline   ActivateField(&quot;Account Id&quot;);_newline   ActivateField(&quot;Address Id&quot;);_newline   ActivateField(&quot;Contact Id&quot;);_newline   ActivateField(&quot;Bill Delivery Mode&quot;); //20161123: To store Bill Delivery Mode on Billing Profile._newline_newline//To create Payment Profile under Billing Account_newline   ActivateField(&quot;Bank Account Number&quot;); // Bank Acc #_newline   ActivateField(&quot;Bank Name&quot;);     // Bank Name_newline   ActivateField(&quot;Bank Branch&quot;);    // Bank Branch_newline   ActivateField(&quot;Bank Routing Number&quot;); // Bank PIN Code_newline   //ActivateField(&quot;Credit Card Number&quot;);  // Credit Card #_newline   ActivateField(&quot;Credit Card Name&quot;);    // Account Holder Name_newline   ActivateField(&quot;Credit Card Type&quot;);    // Card Type_newline   ActivateField(&quot;Credit Card Expiration Month&quot;);    // Card Exp Month_newline   ActivateField(&quot;Credit Card Expiration Year&quot;);     // Card Exp Year_newline   ActivateField(&quot;Bank Account Type&quot;);   // Type: BP or PP_newline   ActivateField(&quot;TM Integration Id&quot;);_newline   ActivateField(&quot;Address Id&quot;);_newline   ActivateField(&quot;Street Address&quot;);_newline   ActivateField(&quot;TM Parent Profile Id&quot;);_newline   ActivateField(&quot;Bank Language Id&quot;);_newline   if(vEntType==&quot;BA&quot; &amp;&amp; vRequestType==&quot;Postpaid&quot;)_newline   {_newline//To create Billing Profile under Billing Account_newline    NewRecord(NewAfter);_newline    SetFieldValue(&quot;Email Bill To&quot;,Outputs.GetProperty(&quot;RegEmail&quot;));_newline    SetFieldValue(&quot;Payment Method&quot;,Outputs.GetProperty(&quot;PaymentMethod&quot;));_newline    if (vPayMethod == &quot;Credit Card&quot; || vPayMethod == &quot;Debit Card&quot;)_newline    {_newline     SetFieldValue(&quot;Credit Card Name&quot;,Outputs.GetProperty(&quot;CardHolder&quot;));_newline     SetFieldValue(&quot;Credit Card Type&quot;,Outputs.GetProperty(&quot;CardType&quot;));_newline     SetFieldValue(&quot;Credit Card Number&quot;,Outputs.GetProperty(&quot;CardNum&quot;));_newline     SetFieldValue(&quot;Credit Card Expiration Month&quot;,Outputs.GetProperty(&quot;CardExpMnth&quot;));_newline     SetFieldValue(&quot;Credit Card Expiration Year&quot;,Outputs.GetProperty(&quot;CardExpYr&quot;));_newline    }_newline       SetFieldValue(&quot;Payment Type&quot;,Outputs.GetProperty(&quot;PaymentType&quot;));_newline       SetFieldValue(&quot;Bill Type&quot;,Outputs.GetProperty(&quot;BillType&quot;));_newline       SetFieldValue(&quot;Bill Frequency&quot;,Outputs.GetProperty(&quot;BillFreq&quot;));_newline       SetFieldValue(&quot;Media Type&quot;,Outputs.GetProperty(&quot;BillMedia&quot;));_newline       SetFieldValue(&quot;Bill Delivery Mode&quot;,Outputs.GetProperty(&quot;BA_usDeliveryMode&quot;)); //20161123:RAHUL: To store Delivery Mode_newline_newline    /* bcPick=vBillProfBc.GetPicklistBusComp(&quot;TM Bill Language&quot;);_newline    bcPick.SetViewMode(AllView);_newline    bcPick.ClearToQuery();_newline    bcPick.SetSearchExpr(&quot;[Bank Language Id]=&apos;&quot; + Outputs.GetProperty(&quot;BillLang&quot;) + &quot;&apos;&quot;);_newline    bcPick.ExecuteQuery(ForwardOnly);_newline    if(bcPick.FirstRecord())_newline     bcPick.Pick(); */_newline//20170317:RAHUL: Changed code to set Bill Language for QC# 9102_newline    SetFieldValue(&quot;Bank Language Id&quot;,Outputs.GetProperty(&quot;BillLang&quot;)); _newline    _newline    SetFieldValue(&quot;TM Integration Id&quot;,Outputs.GetProperty(&quot;BA_usId&quot;))_newline    SetFieldValue(&quot;Account Id&quot;,gvBAccId);_newline    SetFieldValue(&quot;Address Id&quot;,Outputs.GetProperty(&quot;Address_usId&quot;));_newline    SetFieldValue(&quot;Bank Account Type&quot;,&quot;Billing Arrangement&quot;);_newline    SetFieldValue(&quot;Street Address&quot;,Outputs.GetProperty(&quot;StreetAddress&quot;)); _newline    SetFieldValue(&quot;Contact Id&quot;,gvConId); //20160726:RAHUL: To stamp Contact Id on Billing Profile_newline    WriteRecord();_newline    Outputs.SetProperty(&quot;BilProfId&quot;,GetFieldValue(&quot;Id&quot;));_newline    Outputs.SetProperty(&quot;ErrMsg&quot;,&quot;Billing Profile Cretaed&quot;);_newline_newline//To create Payment Profile under Billing Account_newline    NewRecord(NewAfter);_newline    SetFieldValue(&quot;Email Bill To&quot;,Outputs.GetProperty(&quot;RegEmail&quot;));_newline    SetFieldValue(&quot;Bank Account Number&quot;,Outputs.GetProperty(&quot;BankAccNum&quot;));_newline    SetFieldValue(&quot;Bank Name&quot;,Outputs.GetProperty(&quot;BankName&quot;));_newline    SetFieldValue(&quot;Bank Branch&quot;,Outputs.GetProperty(&quot;BankBranch&quot;));_newline    SetFieldValue(&quot;Bank Routing Number&quot;,Outputs.GetProperty(&quot;BankAddPIN&quot;));_newline    SetFieldValue(&quot;TM Integration Id&quot;,Outputs.GetProperty(&quot;PCNId&quot;));  _newline    SetFieldValue(&quot;Bank Account Type&quot;,&quot;PCN&quot;);_newline    SetFieldValue(&quot;Account Id&quot;,Outputs.GetProperty(&quot;BillAccId&quot;));_newline    SetFieldValue(&quot;Address Id&quot;,Outputs.GetProperty(&quot;Address_usId&quot;));_newline    SetFieldValue(&quot;Street Address&quot;,Outputs.GetProperty(&quot;StreetAddress&quot;));_newline    SetFieldValue(&quot;Payment Method&quot;, Outputs.GetProperty(&quot;PaymentMethod&quot;));_newline    vPayMethod = Outputs.GetProperty(&quot;PaymentMethod&quot;);_newline    if (vPayMethod == &quot;Credit Card&quot; || vPayMethod == &quot;Debit Card&quot;)_newline    {_newline     SetFieldValue(&quot;Credit Card Name&quot;,Outputs.GetProperty(&quot;CardHolder&quot;));_newline     SetFieldValue(&quot;Credit Card Type&quot;,Outputs.GetProperty(&quot;CardType&quot;));_newline     SetFieldValue(&quot;Credit Card Number&quot;,Outputs.GetProperty(&quot;CardNum&quot;));_newline     SetFieldValue(&quot;Credit Card Expiration Month&quot;,Outputs.GetProperty(&quot;CardExpMnth&quot;));_newline     SetFieldValue(&quot;Credit Card Expiration Year&quot;,Outputs.GetProperty(&quot;CardExpYr&quot;));_newline    }_newline    SetFieldValue(&quot;Contact Id&quot;,gvConId); //20160726:RAHUL: To stamp Contact Id on Payment Profile_newline    SetFieldValue(&quot;Bill Delivery Mode&quot;,Outputs.GetProperty(&quot;PCN_usDeliveryMode&quot;)); //20161123:RAHUL: To store Delivery Mode_newline    SetFieldValue(&quot;Bank Language Id&quot;,Outputs.GetProperty(&quot;BillLang&quot;)); //20170317:RAHUL: Changed code to set Bill Language for QC# 9102_newline    SetFieldValue(&quot;TM Parent Profile Id&quot;,Outputs.GetProperty(&quot;BilProfId&quot;)); //20160726: To set Billing Prof as Parent of PCN_newline    WriteRecord();_newline    Outputs.SetProperty(&quot;PayProfId&quot;,GetFieldValue(&quot;Id&quot;));_newline    Outputs.SetProperty(&quot;ErrMsg&quot;,&quot;Payment Profile Cretaed&quot;);_newline   }_newline  }// End of vBillProfBc_newline  with(vCAFAccBc)_newline  {_newline   ActivateField(&quot;Account Row Id&quot;);_newline   ActivateField(&quot;Error Message&quot;);_newline   ActivateField(&quot;Account Details Type&quot;);_newline   SetViewMode(AllView);_newline   ClearToQuery();_newline   SetSearchSpec(&quot;TM CAF Id&quot;,gvCAFId);_newline   SetSearchSpec(&quot;Account Details Type&quot;,&quot;BillingProfile-BA&quot;);_newline   ExecuteQuery(ForwardOnly);_newline   IsBillProf = FirstRecord();_newline   if(IsBillProf)_newline   {_newline    SetFieldValue(&quot;Account Row Id&quot;,Outputs.GetProperty(&quot;BilProfId&quot;));_newline    SetFieldValue(&quot;Error Message&quot;,Outputs.GetProperty(&quot;ErrMsg&quot;));_newline    WriteRecord();_newline   }_newline   SetViewMode(AllView);_newline   ClearToQuery();_newline   SetSearchSpec(&quot;TM CAF Id&quot;,gvCAFId);_newline   SetSearchSpec(&quot;Account Details Type&quot;,&quot;BillingProfile-PCN&quot;);_newline   ExecuteQuery(ForwardOnly);_newline   IsPayProf = FirstRecord();_newline   if(IsPayProf)_newline   { _newline    SetFieldValue(&quot;Account Row Id&quot;,Outputs.GetProperty(&quot;PayProfId&quot;));_newline    SetFieldValue(&quot;Error Message&quot;,Outputs.GetProperty(&quot;ErrMsg&quot;));_newline    WriteRecord();_newline   }_newline  }_newline  return(CancelOperation);_newline }_newline catch(e)_newline {_newline  TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure&apos;,&apos;fun_usCreateBillProf&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline  throw e;_newline }_newline finally_newline {_newline  vBillProfBc=null;_newline  vBillProfBo=null;_newline  vCAFAccBc=null;_newline  vCAFBo=null;_newline  bcPick=null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="fun_usCreateBillProf"
 Sequence="5"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="1-HMVV9M"
 Parent_spcName="TM Create Customer BS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="//20151206:RAHUL: Function to create Customer Account_newlinefunction fun_usCreateCA(Inputs, Outputs)_newline{_newline var vAccName,vAccType,vGenCode,vAccStatus,vCircle,vLoc,vDOXId,vIndustry;_newline var vAddrId=&quot;&quot;;_newline var PriceListBC,vCircleBC,vPriceList;_newline var vAccBO = TheApplication().GetBusObject(&quot;Account&quot;);_newline var vAccBC = vAccBO.GetBusComp(&quot;Account&quot;);_newline var vBillProf = vAccBO.GetBusComp(&quot;Com Invoice Profile&quot;);_newline var vAccAddBC=&quot;&quot;,Industry =&quot;&quot;;_newline var vDOXCustType,vDOXCustSubType,vSearch,vBillCycle,vSearchExpr = &quot;&quot;;_newline try_newline {_newline  with(vAccBC)_newline  {_newline   ActivateField(&quot;Name&quot;);_newline   ActivateField(&quot;Type&quot;);_newline   ActivateField(&quot;Account Type Code&quot;);_newline   ActivateField(&quot;Market Class&quot;);_newline   ActivateField(&quot;Market Type&quot;);_newline   ActivateField(&quot;Alias&quot;);_newline   ActivateField(&quot;TM Bill Cycle&quot;);_newline   ActivateField(&quot;Master Account Id&quot;);_newline   ActivateField(&quot;Parent Account Id&quot;);_newline   ActivateField(&quot;Integration Id&quot;);_newline   ActivateField(&quot;Industry&quot;);_newline   ActivateField(&quot;Price List&quot;);_newline   ActivateField(&quot;Organization&quot;);_newline   ActivateField(&quot;Primary Organization Id&quot;);_newline   ActivateField(&quot;Access Level&quot;);_newline   ActivateField(&quot;Ownership Type&quot;);_newline   ActivateField(&quot;Fin Acct - Business Type&quot;);_newline_newline   vDOXId = Outputs.GetProperty(&quot;CA_usId&quot;);_newline   ClearToQuery();_newline   SetViewMode(AllView);_newline   SetSearchSpec(&quot;Integration Id&quot;,vDOXId);_newline   ExecuteQuery(ForwardOnly);_newline   var IsRec = FirstRecord();_newline   if(!IsRec)_newline   {_newline    NewRecord(NewAfter);_newline    SetFieldValue(&quot;Name&quot;,Outputs.GetProperty(&quot;CA_usAccName&quot;));_newline    SetFieldValue(&quot;Account Type Code&quot;,&quot;Customer&quot;);_newline// Below code is to derive Cust Type, Sub Type, Segment and Treatment Status using Dox Type/Sub Type values provided in CAF_newline    vDOXCustType = Outputs.GetProperty(&quot;CA_usCustType&quot;);_newline    vDOXCustSubType = Outputs.GetProperty(&quot;CA_usCustSubType&quot;);_newline    vSearch = vDOXCustType + &quot;:&quot; + vDOXCustSubType;_newline_newline    Outputs.SetProperty(&quot;CustType&quot;,TheApplication().EAILookup(&quot;Internal&quot;,&quot;TM_usCUST_usTYPE&quot;,vSearch));_newline    Outputs.SetProperty(&quot;CustSubType&quot;,TheApplication().EAILookup(&quot;Internal&quot;,&quot;TM_usCUST_usSUB_usTYPE&quot;,vSearch));_newline    Outputs.SetProperty(&quot;CustSegment&quot;,TheApplication().EAILookup(&quot;Internal&quot;,&quot;TM_usCUST_usSEGMENT&quot;,vSearch));_newline    Outputs.SetProperty(&quot;TreatmentStatus&quot;,TheApplication().EAILookup(&quot;Internal&quot;,&quot;TM_usTREATMENT_usSTATUS&quot;,vSearch));_newline    _newline    SetFieldValue(&quot;Type&quot;,TheApplication().EAILookup(&quot;Internal&quot;,&quot;TM_usCUST_usTYPE&quot;,vSearch));_newline    SetFieldValue(&quot;Market Class&quot;,TheApplication().EAILookup(&quot;Internal&quot;,&quot;TM_usCUST_usSUB_usTYPE&quot;,vSearch));_newline    SetFieldValue(&quot;Market Type&quot;,TheApplication().EAILookup(&quot;Internal&quot;,&quot;TM_usCUST_usSEGMENT&quot;,vSearch));_newline    SetFieldValue(&quot;Access Level&quot;,TheApplication().EAILookup(&quot;Internal&quot;,&quot;TM_usTREATMENT_usSTATUS&quot;,vSearch));_newline    SetFieldValue(&quot;Ownership Type&quot;,TheApplication().EAILookup(&quot;Internal&quot;,&quot;TM_usVIL_usCUST_usTYPE&quot;,vSearch));_newline    SetFieldValue(&quot;Fin Acct - Business Type&quot;,TheApplication().EAILookup(&quot;Internal&quot;,&quot;TM_usVIL_usCUST_usSUB_usTYPE&quot;,vSearch));_newline    _newline    Outputs.SetProperty(&quot;TreatmentStatus&quot;,TheApplication().EAILookup(&quot;Internal&quot;,&quot;TM_usTREATMENT_usSTATUS&quot;,vSearch));_newline   _newline//SetFieldValue(&quot;Alias&quot;,Outputs.GetProperty(&quot;CA_usEntCode&quot;));_newline_newline    vGenCode = Outputs.GetProperty(&quot;GEN_usCODE&quot;);_newline //20170315:RAHUL: Get Enterprise Code from Ent Code and Gen Code Matrix, QC#8954_newline    if (vGenCode != &quot;&quot;)_newline    {_newline     fun_usGetEntCode(Inputs, Outputs);  _newline     SetFieldValue(&quot;Alias&quot;,vEntCode);_newline    }_newline  //20160909:RAHUL: To store Bill Cycle date derived from Bill Cycle Code received from cPOS._newline  //SetFieldValue(&quot;TM Bill Cycle&quot;,Outputs.GetProperty(&quot;BillCycle&quot;));_newline    vBillCycle = Outputs.GetProperty(&quot;BillCycle&quot;);_newline    vBillCycle = TheApplication().EAILookup(&quot;Internal&quot;,&quot;TM_usBILL_usCYCLE&quot;,vBillCycle);_newline    SetFieldValue(&quot;TM Bill Cycle&quot;,vBillCycle);_newline_newline    SetFieldValue(&quot;Integration Id&quot;,vDOXId);_newline_newline //To set Price List to the Customer Account_newline    vCircle = Outputs.GetProperty(&quot;Circle&quot;);_newline    vPriceList = &quot;DefaultPriceList&quot; + &quot; &quot; + vCircle;_newline    PriceListBC = GetPicklistBusComp(&quot;Price List&quot;);_newline       with(PriceListBC)_newline       {_newline     ClearToQuery();_newline           SetViewMode(AllView);_newline     //SetSearchSpec(&quot;Name&quot;,vPriceList);_newline     SetSearchExpr(&quot;[Name] = &apos;&quot; + vPriceList + &quot;&apos; &quot;);_newline     ExecuteQuery(ForwardOnly);_newline     if (FirstRecord())_newline         Pick();_newline       }_newline // To Set Circle to Customer Account _newline    vCircleBC = vAccBC.GetMVGBusComp(&quot;Organization&quot;).GetAssocBusComp();_newline    with(vCircleBC)_newline    {_newline     ActivateField(&quot;Name&quot;);_newline     ClearToQuery();_newline     SetViewMode(AllView);_newline     //SetSearchSpec(&quot;Name&quot;,Outputs.GetProperty(&quot;Circle&quot;));_newline     vSearchExpr = &quot;[Name] = &apos;&quot; + vCircle + &quot;&apos; &quot;; //20170321:RAHUL: To Fix Maharashtra and Goa circle issue_newline     SetSearchExpr(vSearchExpr);_newline     ExecuteQuery(ForwardOnly);     _newline     if (FirstRecord())_newline     {_newline      try_newline      {_newline       Associate(NewBefore);_newline      }_newline      catch (e)_newline      {_newline          TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure: Cirlce Association&apos;,&apos;fun_usCreateCA&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline      }_newline     }_newline    }_newline    SetFieldValue(&quot;Primary Organization Id&quot;,vCircleBC.GetFieldValue(&quot;Id&quot;));_newline// To set the Industry to Customer Account_newline/*_newline    vIndustry = vAccBC.GetMVGBusComp(&quot;Industry&quot;).GetAssocBusComp();_newline    if(vIndustry != null &amp;&amp; vIndustry != &quot;&quot;)_newline    {_newline     with(vIndustry)_newline     {_newline      ActivateField(&quot;Name&quot;);_newline      ClearToQuery();_newline      SetViewMode(AllView);_newline      Industry = Outputs.GetProperty(&quot;CA_usIndustry&quot;);_newline      SetSearchExpr(&quot;[Name]= &apos;&quot; + Industry + &quot;&apos;&quot;);_newline      ExecuteQuery(ForwardOnly);_newline      if (FirstRecord())_newline   try_newline      { Associate(NewBefore);}_newline   catch(e)_newline   {_newline  TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure:Industry Assoc&apos;,&apos;fun_usCreateCA&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline   }_newline     }_newline    } _newline*/_newline    WriteRecord();_newline    Outputs.SetProperty(&quot;CAccId&quot;,GetFieldValue(&quot;Id&quot;));_newline    Outputs.SetProperty(&quot;ParentAccId&quot;,GetFieldValue(&quot;Parent Account Id&quot;))_newline    Outputs.SetProperty(&quot;MasterAccId&quot;,GetFieldValue(&quot;Master Account Id&quot;));_newline    Outputs.SetProperty(&quot;ErrMsg&quot;,&quot;Customer Account Created&quot;);_newline    gvCAccId = GetFieldValue(&quot;Id&quot;);_newline   }_newline   else_newline   {_newline    Outputs.SetProperty(&quot;CAccId&quot;,GetFieldValue(&quot;Id&quot;));_newline    Outputs.SetProperty(&quot;ParentAccId&quot;,GetFieldValue(&quot;Parent Account Id&quot;))_newline    Outputs.SetProperty(&quot;MasterAccId&quot;,GetFieldValue(&quot;Master Account Id&quot;));_newline    Outputs.SetProperty(&quot;ErrMsg&quot;,&quot;Customer Account already exist&quot;);_newline    gvCAccId = GetFieldValue(&quot;Id&quot;);_newline   }_newline  }_newline  return(CancelOperation);      _newline }_newline catch(e)_newline {_newline  TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure&apos;,&apos;fun_usCreateCA&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline  throw e;_newline }_newline finally_newline {  _newline  vIndustry=null;_newline  PriceListBC=null;_newline  vCircleBC=null;_newline  vAccAddBC=null;_newline  vAccBC=null;_newline  vAccBO=null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="fun_usCreateCA"
 Sequence="6"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments="20161114: RAHUL: Local Ref Name and Address stored in same field due to field length issue QC # 5105"
 Parent_spcId="1-HMVV9M"
 Parent_spcName="TM Create Customer BS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="//20151208:RAHUL:Function to create Contact_newlinefunction fun_usCreateContact(Inputs, Outputs)_newline{_newline var vFname,vLname,VGender,vSalut,vEmail,vDoB,vContact,vLocalRefName,vLocalRefAdd;_newline var vConBO = TheApplication().GetBusObject(&quot;Account&quot;);_newline var vConBC = vConBO.GetBusComp(&quot;Contact&quot;);_newline var searchst, vIdType, vIdNum;_newline try_newline {_newline  with(vConBC)_newline  {_newline   ActivateField(&quot;First Name&quot;);_newline   ActivateField(&quot;Last Name&quot;); _newline   ActivateField(&quot;Middle Name&quot;);          _newline   ActivateField(&quot;M/F&quot;);_newline   ActivateField(&quot;M/M&quot;);_newline   ActivateField(&quot;Email Address&quot;);_newline   ActivateField(&quot;Birth Date&quot;);_newline   ActivateField(&quot;Account Id&quot;);_newline   ActivateField(&quot;ID Type&quot;);_newline   ActivateField(&quot;SSN&quot;);_newline   ActivateField(&quot;Income Exchange Date&quot;);_newline   ActivateField(&quot;Credit Agency&quot;);_newline   ActivateField(&quot;Driver License Number&quot;);_newline   ActivateField(&quot;DL Expiration Date&quot;);_newline   ActivateField(&quot;Mail Stop&quot;);_newline   ActivateField(&quot;Email Address 2&quot;);_newline   ActivateField(&quot;Cellular Phone #&quot;);_newline   ActivateField(&quot;Assistant Phone #&quot;);_newline   ActivateField(&quot;Alternate Phone #&quot;);_newline   ActivateField(&quot;Language Spoken&quot;);_newline   ActivateField(&quot;Language&quot;);_newline   ActivateField(&quot;Home Phone #&quot;);_newline   ActivateField(&quot;Work Phone #&quot;);_newline   ActivateField(&quot;INS Occupation&quot;);_newline   ActivateField(&quot;Spouse Name&quot;);_newline   ActivateField(&quot;Other ID Number&quot;);_newline   ActivateField(&quot;ID Information&quot;);_newline   ActivateField(&quot;Citizenship&quot;);_newline   ActivateField(&quot;Assistant&quot;);_newline   ActivateField(&quot;Assistant Email Address&quot;);_newline   ActivateField(&quot;Preferred Communications&quot;);_newline   ActivateField(&quot;Comment&quot;);_newline   ActivateField(&quot;Best Call Time&quot;);_newline   ActivateField(&quot;Employer Name&quot;);_newline   ActivateField(&quot;Integration Id&quot;);_newline   ActivateField(&quot;Hair Color&quot;);_newline   ActivateField(&quot;Call Class&quot;);_newline   ActivateField(&quot;Job Title&quot;);_newline   ActivateField(&quot;Type&quot;);_newline   ActivateField(&quot;Driver License Number&quot;);_newline   ActivateField(&quot;ID Expiration Date&quot;);_newline   ActivateField(&quot;Employer Name Free Text&quot;);_newline   ActivateField(&quot;Employee Number&quot;);_newline   ActivateField(&quot;Credit Agency&quot;);_newline   ActivateField(&quot;Mail Stop&quot;);_newline   ActivateField(&quot;Hobby&quot;);_newline   ActivateField(&quot;Status&quot;);_newline   ActivateField(&quot;Subscriber Visa Type&quot;);//20160118:NIWASK:Added for DM12102_newline   ActivateField(&quot;eKyc&quot;);//20160610:Manjunath BA: Added for defect 1176_newline   ActivateField(&quot;Language Code&quot;); //20170317:RAHUL_newline   _newline   vIdType = Outputs.GetProperty(&quot;POI_usType&quot;);_newline   vIdNum = Outputs.GetProperty(&quot;POI_usNum&quot;);_newline   searchst = &quot;[ID Type] = &apos;&quot; + vIdType + &quot;&apos; AND [SSN] = &apos;&quot; + vIdNum + &quot;&apos;&quot;;_newline_newline   SetViewMode(AllView);_newline   ClearToQuery();_newline// 20160830: RAHUL: If NOT AVAILABLE comes in ID Number, removed serachspec added serachexpr_newline   //SetSearchSpec(&quot;ID Type&quot;,Outputs.GetProperty(&quot;POI_usType&quot;));_newline   //SetSearchSpec(&quot;SSN&quot;,Outputs.GetProperty(&quot;POI_usNum&quot;));_newline   SetSearchExpr(searchst );_newline   ExecuteQuery(ForwardOnly);_newline   vContact = FirstRecord();_newline   if(!vContact)_newline   {_newline    NewRecord(NewAfter);_newline    SetFieldValue(&quot;Status&quot;, &quot;Active&quot;);_newline    SetFieldValue(&quot;M/M&quot;,Outputs.GetProperty(&quot;Salutation&quot;));_newline    SetFieldValue(&quot;First Name&quot;,Outputs.GetProperty(&quot;FirstName&quot;));_newline    SetFieldValue(&quot;Middle Name&quot;,Outputs.GetProperty(&quot;MiddleName&quot;));_newline    SetFieldValue(&quot;Last Name&quot;,Outputs.GetProperty(&quot;LastName&quot;));_newline    SetFieldValue(&quot;Email Address&quot;,Outputs.GetProperty(&quot;Email&quot;));_newline    SetFieldValue(&quot;Birth Date&quot;,Outputs.GetProperty(&quot;BirthDate&quot;));_newline    SetFieldValue(&quot;ID Type&quot;,Outputs.GetProperty(&quot;POI_usType&quot;));_newline    SetFieldValue(&quot;SSN&quot;,Outputs.GetProperty(&quot;POI_usNum&quot;));_newline    SetFieldValue(&quot;M/F&quot;,Outputs.GetProperty(&quot;Gender&quot;)); _newline    SetFieldValue(&quot;Email Address 2&quot;,Outputs.GetProperty(&quot;AltEmail&quot;));_newline    //SetFieldValue(&quot;EmployeeNum&quot;,Outputs.GetProperty(&quot;&quot;));_newline    SetFieldValue(&quot;Employer Name Free Text&quot;,Outputs.GetProperty(&quot;EmployerName&quot;));_newline    //SetFieldValue(&quot;Employer Number&quot;,Outputs.GetProperty(&quot;EmployeeNum&quot;));_newline    //SetFieldValue(&quot;Alternate Phone #&quot;,Outputs.GetProperty(&quot;AltContNum&quot;));//BHAVESHG:13JUNE2017:Commented for defect#11676._newline    SetFieldValue(&quot;Assistant Phone #&quot;,Outputs.GetProperty(&quot;AltContNum&quot;));//BHAVESHG:13JUNE2017:Added for defect#11676._newline_newline    SetFieldValue(&quot;ID Expiration Date&quot;,Outputs.GetProperty(&quot;POI_usExpiry&quot;));_newline    SetFieldValue(&quot;Credit Agency&quot;,Outputs.GetProperty(&quot;POI_usIssue_usPlace&quot;));_newline    SetFieldValue(&quot;Mail Stop&quot;,Outputs.GetProperty(&quot;POIApprvlAuth&quot;));_newline    SetFieldValue(&quot;Best Call Time&quot;,Outputs.GetProperty(&quot;BestCallTime&quot;));_newline    //SetFieldValue(&quot;&quot;,Outputs.GetProperty(&quot;ContactNum&quot;));_newline    SetFieldValue(&quot;Income Exchange Date&quot;,Outputs.GetProperty(&quot;POI_usIssue_usDt&quot;));_newline    //SetFieldValue(&quot;&quot;,Outputs.GetProperty(&quot;Dept&quot;));_newline    //SetFieldValue(&quot;Designation&quot;,Outputs.GetProperty(&quot;Desgn&quot;));_newline    SetFieldValue(&quot;Hobby&quot;,Outputs.GetProperty(&quot;Hobby&quot;));_newline    SetFieldValue(&quot;Home Phone #&quot;,Outputs.GetProperty(&quot;HomePhnNum&quot;));_newline    SetFieldValue(&quot;eKyc&quot;,Outputs.GetProperty(&quot;eKYC&quot;));//20160610:Manjunath BA: Modified for defect 1176_newline    SetFieldValue(&quot;Job Title&quot;,Outputs.GetProperty(&quot;JobTitle&quot;));_newline    SetFieldValue(&quot;Cellular Phone #&quot;,Outputs.GetProperty(&quot;MobilePhone&quot;));_newline    SetFieldValue(&quot;Citizenship&quot;,Outputs.GetProperty(&quot;Nationality&quot;));_newline    //SetFieldValue(&quot;&quot;,Outputs.GetProperty(&quot;PortStayPermtDt&quot;));_newline    SetFieldValue(&quot;Preferred Communications&quot;,Outputs.GetProperty(&quot;PrefComm&quot;));_newline    SetFieldValue(&quot;Language Spoken&quot;,Outputs.GetProperty(&quot;SpokenLang&quot;));_newline    SetFieldValue(&quot;ID Information&quot;,Outputs.GetProperty(&quot;AadharNum&quot;));_newline    SetFieldValue(&quot;Other ID Number&quot;,Outputs.GetProperty(&quot;PAN&quot;));_newline    //SetFieldValue(&quot;Passport&quot;,Outputs.GetProperty(&quot;Passport&quot;));_newline    SetFieldValue(&quot;Driver License Number&quot;,Outputs.GetProperty(&quot;VISANum&quot;));_newline    SetFieldValue(&quot;DL Expiration Date&quot;,Outputs.GetProperty(&quot;VISAExp&quot;));// 16/05/2016 MBA: Defect 943: changed the process property name from VisaExp to VISAExp._newline    SetFieldValue(&quot;Spouse Name&quot;,Outputs.GetProperty(&quot;FMMaidenName&quot;));// 16/05/2016 MBA: Defect 857: Added the script to ensure the Father&apos;s Name is also populated._newline    SetFieldValue(&quot;Comment&quot;,Outputs.GetProperty(&quot;Comment&quot;));_newline    SetFieldValue(&quot;Subscriber Visa Type&quot;,Outputs.GetProperty(&quot;VisaType&quot;));//20160118:NIWASK:Added for DM12102_newline    SetFieldValue(&quot;Language Code&quot;,Outputs.GetProperty(&quot;WrittenLang&quot;)); //20170317:RAHUL_newline    _newline    vLocalRefName = Outputs.GetProperty(&quot;LocalRefFName&quot;) + &quot; &quot; + Outputs.GetProperty(&quot;LocalRefMName&quot;) + &quot; &quot; + Outputs.GetProperty(&quot;LocalRefLName&quot;);_newline    vLocalRefAdd =  Outputs.GetProperty(&quot;LocalRefConNum&quot;) + &quot;:&quot; + Outputs.GetProperty(&quot;LocalRefAdd&quot;) + &quot;:&quot; + Outputs.GetProperty(&quot;LocalHotelAdd&quot;) + &quot;:&quot; + Outputs.GetProperty(&quot;LocalHotelName&quot;);_newline_newline//20161114:RAHUL: Local Ref Name and Address Details to be stored in same field due to length constraint_newline    vLocalRefAdd = vLocalRefName + &quot;:&quot; + vLocalRefAdd;_newline    // SetFieldValue(&quot;Assistant&quot;,vLocalRefName);_newline    SetFieldValue(&quot;Assistant Email Address&quot;,vLocalRefAdd);_newline    SetFieldValue(&quot;Type&quot;,Outputs.GetProperty(&quot;TreatmentStatus&quot;));_newline    //SetFieldValue(&quot;Citizenship&quot;,Outputs.GetProperty(&quot;NameLinkType&quot;));  _newline    WriteRecord();_newline    Outputs.SetProperty(&quot;ContactId&quot;,GetFieldValue(&quot;Id&quot;));_newline    Outputs.SetProperty(&quot;ContErrMsg&quot;,&quot;New Contact Created&quot;);_newline    gvConId = GetFieldValue(&quot;Id&quot;);_newline   }_newline   else_newline   {_newline    Outputs.SetProperty(&quot;ContactId&quot;,GetFieldValue(&quot;Id&quot;));_newline    Outputs.SetProperty(&quot;ContErrMsg&quot;,&quot;Existing Contact Used&quot;);_newline    gvConId = GetFieldValue(&quot;Id&quot;);_newline   }_newline  }_newline  return(CancelOperation);  _newline }_newline catch(e)_newline {_newline  TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure&apos;,&apos;fun_usCreateContact&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline  throw e;_newline }_newline finally_newline {_newline  vConBC=null;_newline  vConBO=null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="fun_usCreateContact"
 Sequence="7"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="1-HMVV9M"
 Parent_spcName="TM Create Customer BS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="/*---------------------------------------------------------------------------------_newline20151206:RAHUL: This function creates Sub Account after reading values from_newlineproperty set captured in function fun_usReadCAFAccount. Sub Account get linked under_newlineCustomer Account_newline-----------------------------------------------------------------------------------*/_newlinefunction fun_usCreateSA(Inputs, Outputs)_newline{_newline var vAccName,vAccType,vGenCode,vAccStatus,vCircle,vLoc,vDOXId,vPriceList,vSearchExpr = &quot;&quot;;_newline var PriceListBC,vCircleBC,vParentDoxId,vParentAccId,vMasterAccId, vDOXCustType, vDOXCustSubType, vSearch;_newline var vAccBO = TheApplication().GetBusObject(&quot;Account&quot;);_newline var vSubAccBC = vAccBO.GetBusComp(&quot;Account&quot;);_newline try_newline {_newline  vSubAccBC.ActivateField(&quot;Name&quot;);_newline  vSubAccBC.ActivateField(&quot;Type&quot;);_newline  vSubAccBC.ActivateField(&quot;Account Type Code&quot;);_newline  vSubAccBC.ActivateField(&quot;Market Class&quot;);_newline  vSubAccBC.ActivateField(&quot;Market Type&quot;);_newline  vSubAccBC.ActivateField(&quot;Alias&quot;);_newline  vSubAccBC.ActivateField(&quot;TM Bill Cycle&quot;);_newline  vSubAccBC.ActivateField(&quot;Master Account Id&quot;);_newline  vSubAccBC.ActivateField(&quot;Parent Account Id&quot;);_newline  vSubAccBC.ActivateField(&quot;Integration Id&quot;);_newline  vSubAccBC.ActivateField(&quot;Industry&quot;);_newline  vSubAccBC.ActivateField(&quot;Price List&quot;);_newline  vSubAccBC.ActivateField(&quot;Organization&quot;);_newline  vSubAccBC.ActivateField(&quot;Primary Organization Id&quot;);_newline  vSubAccBC.ActivateField(&quot;Access Level&quot;);_newline  vDOXId = Outputs.GetProperty(&quot;OU_usId&quot;);_newline  vSubAccBC.ClearToQuery();_newline  vSubAccBC.SetViewMode(AllView);_newline  vSubAccBC.SetSearchSpec(&quot;Integration Id&quot;,vDOXId);_newline  vSubAccBC.ExecuteQuery(ForwardOnly);_newline  var IsRec = vSubAccBC.FirstRecord();_newline  if(!IsRec)_newline  {_newline   vSubAccBC.NewRecord(NewAfter);_newline   vSubAccBC.SetFieldValue(&quot;Name&quot;,Outputs.GetProperty(&quot;SA_usAccName&quot;));_newline_newline// Below code is to derive Cust Type, Sub Type, Segment and Treatment Status using Dox Type/Sub Type values provided in CAF_newline   //vDOXCustType = Outputs.GetProperty(&quot;CA_usCustType&quot;);_newline   //vDOXCustSubType = Outputs.GetProperty(&quot;CA_usCustSubType&quot;);_newline   //vSearch = vDOXCustType + &quot;:&quot; + vDOXCustSubType;_newline// Take below values from Parent Customer    _newline   vSubAccBC.SetFieldValue(&quot;Type&quot;,Outputs.GetProperty(&quot;CustType&quot;));_newline   vSubAccBC.SetFieldValue(&quot;Market Class&quot;,Outputs.GetProperty(&quot;CustSubType&quot;));_newline   vSubAccBC.SetFieldValue(&quot;Market Type&quot;,Outputs.GetProperty(&quot;CustSegment&quot;));_newline   vSubAccBC.SetFieldValue(&quot;Access Level&quot;,Outputs.GetProperty(&quot;TreatmentStatus&quot;));_newline   _newline   vSubAccBC.SetFieldValue(&quot;Account Type Code&quot;,&quot;Sub Account&quot;);_newline   // vSubAccBC.SetFieldValue(&quot;Alias&quot;,Outputs.GetProperty(&quot;SA_usEntCode&quot;));_newline   vGenCode = Outputs.GetProperty(&quot;GEN_usCODE&quot;);_newline//20170315:RAHUL: Get Enterprise Code from Ent Code and Gen Code Matrix, QC#8954_newline   if (vGenCode != &quot;&quot;)_newline   {_newline    fun_usGetEntCode(Inputs, Outputs);  _newline    vSubAccBC.SetFieldValue(&quot;Alias&quot;,vEntCode);_newline   }_newline   vSubAccBC.SetFieldValue(&quot;TM Bill Cycle&quot;,Outputs.GetProperty(&quot;BillCycle&quot;));_newline   vSubAccBC.SetFieldValue(&quot;Integration Id&quot;,vDOXId);_newline   vSubAccBC.SetFieldValue(&quot;Parent Account Id&quot;,Outputs.GetProperty(&quot;CAccId&quot;));_newline   vSubAccBC.SetFieldValue(&quot;Master Account Id&quot;,Outputs.GetProperty(&quot;MasterAccId&quot;))_newline   //vSubAccBC.SetFieldValue(&quot;Industry&quot;,Outputs.GetProperty(&quot;CA_usIndustry&quot;));_newline//To set Price List to the Sub Account_newline   _newline   vCircle = Outputs.GetProperty(&quot;Circle&quot;);_newline   vPriceList = &quot;DefaultPriceList&quot; + &quot; &quot; + vCircle;_newline   PriceListBC = vSubAccBC.GetPicklistBusComp(&quot;Price List&quot;);_newline   with(PriceListBC)_newline   {_newline    ClearToQuery();_newline             SetViewMode(AllView);_newline             //SetSearchSpec(&quot;Name&quot;,vPriceList);_newline    SetSearchExpr(&quot;[Name] = &apos;&quot; + vPriceList + &quot;&apos; &quot;); //20170321:RAHUL:To fix Maharashtra and Goa circle issue_newline             ExecuteQuery(ForwardOnly);_newline             if (FirstRecord())_newline          Pick();_newline   }_newline_newline// To Set Circle to Sub Account _newline   vCircleBC = vSubAccBC.GetMVGBusComp(&quot;Organization&quot;).GetAssocBusComp();_newline   with(vCircleBC)_newline   {_newline    ActivateField(&quot;Name&quot;);_newline    ClearToQuery();_newline    SetViewMode(AllView);_newline    //SetSearchSpec(&quot;Name&quot;,Outputs.GetProperty(&quot;Circle&quot;));_newline    vSearchExpr = &quot;[Name] = &apos;&quot; + vCircle + &quot;&apos; &quot;; //20170321:RAHUL: To Fix Maharashtra and Goa circle issue_newline    SetSearchExpr(vSearchExpr);_newline    ExecuteQuery(ForwardOnly);_newline    if (FirstRecord())_newline    {_newline     try_newline     {_newline      Associate(NewBefore);_newline     }_newline     catch (e)_newline     {_newline       TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure: Cirlce Association&apos;,&apos;fun_usCreateCA&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline     }_newline    }_newline   }_newline   vSubAccBC.SetFieldValue(&quot;Primary Organization Id&quot;,vCircleBC.GetFieldValue(&quot;Id&quot;));_newline// To set Parent and Master Account Id in case Id is passed by cPOS in Parent External Account Id_newline   _newline   vParentDoxId = Outputs.GetProperty(&quot;ExtParentAccId&quot;);_newline   if(vParentDoxId != null &amp;&amp; vParentDoxId != &quot;&quot;)_newline   {_newline    fun_usGetParentAcc(Inputs, Outputs);_newline    vParentAccId = Outputs.GetProperty(&quot;ParentAccountId&quot;);_newline    vMasterAccId = Outputs.GetProperty(&quot;MasterAccountId&quot;);_newline    vSubAccBC.SetFieldValue(&quot;Parent Account Id&quot;,vParentAccId);_newline    vSubAccBC.SetFieldValue(&quot;Master Account Id&quot;,vMasterAccId);_newline    vSubAccBC.SetFieldValue(&quot;Type&quot;, Outputs.GetProperty(&quot;ParentCustType&quot;));_newline    vSubAccBC.SetFieldValue(&quot;Market Class&quot;,Outputs.GetProperty(&quot;ParentCustSubType&quot;));_newline    vSubAccBC.SetFieldValue(&quot;Access Level&quot;,Outputs.GetProperty(&quot;ParentTreatStatus&quot;));_newline   }// End of ifif(vParentDoxId != null || vParentDoxId != &quot;&quot;)_newline   else_newline   {_newline    vSubAccBC.SetFieldValue(&quot;Parent Account Id&quot;,Outputs.GetProperty(&quot;CAccId&quot;));_newline    vSubAccBC.SetFieldValue(&quot;Master Account Id&quot;,Outputs.GetProperty(&quot;MasterAccId&quot;));_newline   }_newline   vSubAccBC.WriteRecord();_newline   Outputs.SetProperty(&quot;SAccId&quot;,vSubAccBC.GetFieldValue(&quot;Id&quot;));_newline  }_newline  else_newline  {_newline   Outputs.SetProperty(&quot;SAccId&quot;,vSubAccBC.GetFieldValue(&quot;Id&quot;));_newline   Outputs.SetProperty(&quot;ErrMsg&quot;,&quot;Sub Account already exist&quot;);_newline   gvSAccId = vSubAccBC.GetFieldValue(&quot;Id&quot;);_newline  }_newline  return(CancelOperation);      _newline }_newline catch(e)_newline {_newline  TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure&apos;,&apos;fun_usCreateSA&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline  throw e;_newline }_newline finally_newline { _newline  PriceListBC=null;_newline  vCircleBC=null;_newline  vSubAccBC=null;_newline  vAccBO=null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="fun_usCreateSA"
 Sequence="8"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments="20170514:RAHUL: Corrected BC field names for Enterprise Code"
 Parent_spcId="1-HMVV9M"
 Parent_spcName="TM Create Customer BS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="/*_newline20170315:RAHUL: This function queries the BC with GEN_usCODE recived from cPOS,_newlineand retreives Enterprise Code to update on Account._newlineChange made for QC# 8954 _newline*/_newline_newlinefunction fun_usGetEntCode(Inputs, Outputs)_newline{_newline var vGEN_usCODE = &quot;&quot;,vEntBO,vEntBC;_newline try_newline {_newline  vGEN_usCODE = Outputs.GetProperty(&quot;GEN_usCODE&quot;);_newline  vEntBO   = TheApplication().GetBusObject(&quot;TM Enterprise Code&quot;);_newline  vEntBC   = vEntBO.GetBusComp(&quot;TM DOX GEN CODES BC&quot;);_newline  if (vGEN_usCODE != &quot;&quot;)_newline  {_newline   vEntBC.ActivateField(&quot;GEN_usCODE&quot;);_newline   vEntBC.ActivateField(&quot;Enterprise Code&quot;);_newline   vEntBC.ActivateField(&quot;Type&quot;);_newline   vEntBC.ClearToQuery();_newline   vEntBC.SetViewMode(AllView);_newline   vEntBC.SetSearchSpec(&quot;GEN_usCODE&quot;,vGEN_usCODE);_newline   vEntBC.SetSearchSpec(&quot;Type&quot;,&quot;L9_usTAGENT&quot;);_newline   vEntBC.ExecuteQuery(ForwardOnly);_newline   if(vEntBC.FirstRecord())_newline   {_newline    vEntCode = vEntBC.GetFieldValue(&quot;Enterprise Code&quot;);_newline    Outputs.SetProperty(&quot;EntCode&quot;,vEntCode);_newline   }_newline  }_newline  return(CancelOperation);_newline }_newline catch(e)_newline {_newline  TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure&apos;,&apos;fun_usGetEntCode&apos;,&apos;&apos;,&apos;TMCreateAccountService&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline }_newline    finally_newline {_newline  vEntBC = null;_newline  vEntBO = null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="fun_usGetEntCode"
 Sequence="9"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="1-HMVV9M"
 Parent_spcName="TM Create Customer BS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="/*--------------------------------------------------------------------------------------------_newline20120228:RAHUL SHAH_newlineThis function is used to set the parent account of Sub Account based on the DOX ID provided in_newlinefield External Parent Account Id, it queries in DOX Id stored in Integrtion Id field and returns_newlineSiebel row Id which is being used to set as Parent Account Id _newline----------------------------------------------------------------------------------------------*/_newlinefunction fun_usGetParentAcc(Inputs, Outputs)_newline{_newline var vAccBO = TheApplication().GetBusObject(&quot;Account&quot;);_newline var vAccBC = vAccBO.GetBusComp(&quot;Account&quot;);_newline var vRec,vAccId;_newline try_newline {_newline  vAccId = Outputs.GetProperty(&quot;ExtParentAccId&quot;);_newline  if(vAccId !=null &amp;&amp; vAccId !=&quot;&quot;)_newline  {_newline   vAccBC.ActivateField(&quot;Integration Id&quot;);_newline   vAccBC.ClearToQuery();_newline   vAccBC.SetViewMode(AllView);_newline   vAccBC.SetSearchSpec(&quot;Integration Id&quot;,vAccId);_newline   vAccBC.ActivateField(&quot;Access Level&quot;);_newline   vAccBC.ActivateField(&quot;Ownership Type&quot;);_newline   vAccBC.ActivateField(&quot;Fin Acct - Business Type&quot;);_newline   vAccBC.ExecuteQuery(ForwardOnly);_newline   vRec = vAccBC.FirstRecord();_newline   if(vRec)_newline   {_newline    Outputs.SetProperty(&quot;ParentAccountId&quot;,vAccBC.GetFieldValue(&quot;Id&quot;));_newline    Outputs.SetProperty(&quot;MasterAccountId&quot;,vAccBC.GetFieldValue(&quot;Master Account Id&quot;));_newline    Outputs.SetProperty(&quot;ParentCustType&quot;, vAccBC.GetFieldValue(&quot;Type&quot;));_newline    Outputs.SetProperty(&quot;ParentCustSubType&quot;, vAccBC.GetFieldValue(&quot;Market Class&quot;));_newline    Outputs.SetProperty(&quot;ParentTreatStatus&quot;, vAccBC.GetFieldValue(&quot;Access Level&quot;));_newline    Outputs.SetProperty(&quot;VILCustType&quot;, vAccBC.GetFieldValue(&quot;Ownership Type&quot;));_newline    Outputs.SetProperty(&quot;VILCustSubType&quot;, vAccBC.GetFieldValue(&quot;Fin Acct - Business Type&quot;));_newline   }_newline   else_newline   {_newline    strErrCode = &quot;PARENTID_usNOT_usFOUND&quot;;_newline    strErrMesg = &quot;Parent Id not found in Siebel&quot;;_newline    return (CancelOperation);_newline   }_newline  }_newline  return (CancelOperation);_newline }_newline catch(e)_newline {_newline  TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure&apos;,&apos;fun_usGetParentAcc&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline  throw e;_newline }_newline finally_newline {_newline  vAccBC=null;_newline  vAccBO=null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="fun_usGetParentAcc"
 Sequence="10"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="1-HMVV9M"
 Parent_spcName="TM Create Customer BS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="/* 20160216: RAHUL SHAH_newline--------------------------------------------------------------------------------------------_newlineThis function is used to fetch Siebel Id of entities passed as input based on the Refrence Id_newlineprovided from CAF BCs._newline---------------------------------------------------------------------------------------------*/_newline_newlinefunction fun_usGetSiebelId(Inputs, Outputs)_newline{_newline var vEntityType,vEntRefId,vAddReqRefId,vContReqRefId;_newline var vCAFBO = TheApplication().GetBusObject(&quot;TM CAF Details BO&quot;);_newline var vCAFMstBc = vCAFBO.GetBusComp(&quot;TM CAF Master BC&quot;);_newline var vCAFAccBC = vCAFBO.GetBusComp(&quot;TM CAF Account Details BC&quot;);_newline var vCAFAddBC =vCAFBO.GetBusComp(&quot;TM CAF Address BC&quot;);_newline var vCAFContBC =vCAFBO.GetBusComp(&quot;TM CAF Contact BC&quot;);_newline try_newline {_newline  vCAFMstBc.SetViewMode(AllView);_newline  vCAFMstBc.ClearToQuery();_newline  vCAFMstBc.SetSearchExpr(&quot;[CAF Id] = &apos;&quot; + gvCAFId +&quot;&apos;&quot;);_newline  vCAFMstBc.ExecuteQuery(ForwardOnly);_newline  if (vCAFMstBc.FirstRecord())_newline  {_newline   vEntityType = Inputs.GetProperty(&quot;EntityType&quot;);_newline   vEntRefId = Inputs.GetProperty(&quot;EntRefId&quot;);_newline   vAddReqRefId = Inputs.GetProperty(&quot;AddReqRefId&quot;);_newline   vContReqRefId = Inputs.GetProperty(&quot;ContReqRefId&quot;);_newline   if(vEntityType==&quot;Account&quot; || vEntityType == &quot;Customer&quot;)_newline   {_newline    with(vCAFAccBC)_newline    {_newline     ActivateField(&quot;Account Details Type&quot;);_newline     ActivateField(&quot;Request Reference Id&quot;);_newline     ActivateField(&quot;TM CAF Id&quot;);_newline     ActivateField(&quot;Account Row Id&quot;);_newline     SetViewMode(AllView);_newline     ClearToQuery();_newline     //SetSearchSpec(&quot;Account Details Type&quot;,vEntityType);_newline     SetSearchSpec(&quot;Request Reference Id&quot;,vEntRefId);_newline     SetSearchSpec(&quot;TM CAF Id&quot;,gvCAFId);_newline     ExecuteQuery(ForwardOnly);_newline     var IsPresent = FirstRecord();_newline     if(IsPresent)_newline     {_newline      Outputs.SetProperty(&quot;SiebelID&quot;,GetFieldValue(&quot;Account Row Id&quot;));_newline      Outputs.SetProperty(&quot;ErrMsg&quot;,&quot;Reference found&quot;);_newline     }_newline     else_newline     {_newline      Outputs.SetProperty(&quot;ErrMsg&quot;,&quot;Reference not found&quot;);     _newline     } _newline    } _newline   }_newline   if(vAddReqRefId !=null &amp;&amp; vAddReqRefId != &quot;&quot;)_newline   {_newline    with(vCAFAddBC)_newline    { _newline     ActivateField(&quot;Request Reference Id&quot;);_newline     ActivateField(&quot;TM Address Link Type&quot;);_newline     ActivateField(&quot;Address Id&quot;);_newline     SetViewMode(AllView);_newline     ClearToQuery();_newline     SetSearchSpec(&quot;Request Reference Id&quot;,vAddReqRefId);_newline     //SetSearchSpec(&quot;TM CAF Id&quot;,gvCAFId);_newline     ExecuteQuery(ForwardOnly);_newline_newline     var IsAddr = FirstRecord();_newline        if(IsAddr)_newline        {_newline             Outputs.SetProperty(&quot;Address_usId&quot;,GetFieldValue(&quot;Address Id&quot;));_newline             Outputs.SetProperty(&quot;ErrMsg&quot;,&quot;Address Reference found&quot;);_newline             Outputs.SetProperty(&quot;StreetAddress&quot;,GetFieldValue(&quot;TM Address Link Type&quot;));_newline             Outputs.SetProperty(&quot;AddressType&quot;,GetFieldValue(&quot;Address Type&quot;));_newline    TheApplication().LogError(&apos;Script&apos;,&apos;Debug&apos;,&apos;AddrCreate&apos;,&apos;Debug&apos;+gvCAFId+&quot;:&quot;+GetFieldValue(&quot;Address Id&quot;),&apos;fun_usGetSiebelId: Address:&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline        }_newline     else_newline     {_newline      Outputs.SetProperty(&quot;ErrMsg&quot;,&quot;Address Reference not found&quot;);_newline     }_newline    }_newline   }_newline   if(vContReqRefId !=null &amp;&amp; vContReqRefId !=&quot;&quot;)_newline   {_newline    with(vCAFContBC)_newline    {_newline     ActivateField(&quot;Contact Id&quot;);_newline     ActivateField(&quot;Request Reference Id&quot;);_newline     ActivateField(&quot;TM CAF Id&quot;);_newline     SetViewMode(AllView);_newline     ClearToQuery()_newline     SetSearchSpec(&quot;Request Reference Id&quot;,vContReqRefId);_newline     //SetSearchSpec(&quot;TM CAF Id&quot;,gvCAFId);_newline     ExecuteQuery(ForwardOnly);_newline     var IsContact = FirstRecord();_newline     if(IsContact)_newline     {_newline      Outputs.SetProperty(&quot;Contact_usId&quot;,GetFieldValue(&quot;Contact Id&quot;));_newline      Outputs.SetProperty(&quot;ErrMsg&quot;,&quot;Contact Reference found&quot;);_newline     }_newline     else_newline     {_newline      Outputs.SetProperty(&quot;ErrMsg&quot;,&quot;Contact Reference not found&quot;);   _newline     }_newline    }_newline   }_newline  }_newline  return(CancelOperation);_newline } // added by VJ_newline_newline catch(e)_newline {_newline  TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure&apos;,&apos;fun_usGetSiebelId&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline  throw e;_newline }_newline finally_newline {_newline  vCAFContBC=null;_newline  vCAFAddBC=null;_newline  vCAFAccBC=null;_newline  vCAFBO=null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="fun_usGetSiebelId"
 Sequence="11"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="1-HMVV9M"
 Parent_spcName="TM Create Customer BS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="/* 20160212:RAHUL_newline--------------------------------------------------------------_newlineThis function creates a dummy Billing Profile only for new Prepaid connection under Customer Account _newlineand stamps Bill Profile Id in CAF MSISDN BC against each MSISDN record which will be further stamped_newlineon Order Line Items._newline-------------------------------------------------------------- */_newline_newlinefunction fun_usPrepaidBillProf(Inputs, Outputs)_newline{_newline var vAccBO = TheApplication().GetBusObject(&quot;Account&quot;);_newline var vBillProf = vAccBO.GetBusComp(&quot;Com Invoice Profile&quot;);_newline var vCAFBO = TheApplication().GetBusObject(&quot;TM CAF Additional Info BO&quot;);_newline var vCAFMSISDN = vCAFBO.GetBusComp(&quot;TM CAF MSISDN BC&quot;);_newline var vRec,vRequestType;_newline var vPreBillProfId=&quot;&quot;;_newline try_newline {_newline  //vRequestType = Outputs.GetProperty(&quot;RequestType&quot;);_newline  vRequestType = Outputs.GetProperty(&quot;SubscriberType&quot;);_newline  _newline  if (vRequestType==&quot;Prepaid&quot;)_newline  {_newline   vBillProf.ActivateField(&quot;Payment Type&quot;);_newline   vBillProf.ActivateField(&quot;Account Id&quot;);_newline   vBillProf.ActivateField(&quot;Address Id&quot;);_newline   vBillProf.ActivateField(&quot;Street Address&quot;);_newline   vBillProf.ActivateField(&quot;Email Bill To&quot;);_newline   vBillProf.NewRecord(NewAfter);_newline   vBillProf.SetFieldValue(&quot;Payment Type&quot;,&quot;Prepaid&quot;);_newline   vBillProf.SetFieldValue(&quot;Account Id&quot;,gvCAccId);_newline   vBillProf.SetFieldValue(&quot;Address Id&quot;,Outputs.GetProperty(&quot;Address_usId&quot;));_newline   vBillProf.SetFieldValue(&quot;Street Address&quot;,Outputs.GetProperty(&quot;StreetAddress&quot;));_newline   vBillProf.SetFieldValue(&quot;Email Bill To&quot;,Outputs.GetProperty(&quot;Email&quot;));  // 20160603:RAHUL: In case of Prepaid Contact Email Id will be stored in Billing Profile_newline   _newline   vBillProf.WriteRecord();_newline   vPreBillProfId = vBillProf.GetFieldValue(&quot;Id&quot;);_newline   Outputs.SetProperty(&quot;Prep_usBillProf&quot;,vPreBillProfId );_newline   gvPrpdBillProf = vBillProf.GetFieldValue(&quot;Id&quot;);_newline  } _newline  if(vPreBillProfId !=null || vPreBillProfId !=&quot;&quot;)_newline  {_newline   vCAFMSISDN.ActivateField(&quot;TM CAF Id&quot;);_newline   vCAFMSISDN.ActivateField(&quot;TM Siebel Billing Profile PCN Id&quot;);_newline   vCAFMSISDN.SetViewMode(AllView);_newline   vCAFMSISDN.ClearToQuery();_newline   vCAFMSISDN.SetSearchSpec(&quot;TM CAF Id&quot;,gvCAFId);_newline   vCAFMSISDN.ExecuteQuery(ForwardOnly);_newline   vRec= vCAFMSISDN.FirstRecord();_newline   while(vRec)_newline   {_newline    vCAFMSISDN.SetFieldValue(&quot;TM Siebel Billing Profile PCN Id&quot;,vPreBillProfId);_newline    vCAFMSISDN.WriteRecord();_newline    vRec = vCAFMSISDN.NextRecord();_newline   }_newline  }_newline  return(CancelOperation);_newline }_newline catch(e)_newline {_newline  TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure&apos;,&apos;fun_usPrepaidBillProf&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline  throw e;_newline }_newline finally_newline {_newline   vCAFMSISDN=null;_newline   vCAFBO=null;_newline   vBillProf=null;_newline   vAccBO=null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="fun_usPrepaidBillProf"
 Sequence="12"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="1-HMVV9M"
 Parent_spcName="TM Create Customer BS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="/* RAHUL_newlineThis function reads CAF Account Data from CAF table and then will be used to create Customer _newlineAccount(CA), Billing Account(FA), Billing Profile(BA) and Payment Profile (PCN). */_newline_newlinefunction fun_usReadCAFAccount(Inputs, Outputs)_newline{_newline var vCAFBo = TheApplication().GetBusObject(&quot;TM CAF Details BO&quot;);_newline var vCAFMstrBc = vCAFBo.GetBusComp(&quot;TM CAF Master BC&quot;);_newline var vCAFAccBc = vCAFBo.GetBusComp(&quot;TM CAF Account Details BC&quot;);_newline var IsSubAcc,searchst,vEntCode;_newline try_newline {_newline  with(vCAFMstrBc)_newline  {_newline   ActivateField(&quot;CAF Id&quot;);_newline   ActivateField(&quot;TM Siebel Cust Account Id&quot;);_newline   ActivateField(&quot;Status&quot;);_newline   ActivateField(&quot;Request Reference Id&quot;);_newline   ActivateField(&quot;Circle Name&quot;);_newline   ActivateField(&quot;Circle_usID&quot;);_newline   ActivateField(&quot;Enterprise Code&quot;); //20170316:RAHUL:Added for QC#8954_newline   //ActivateField(&quot;Request Type&quot;);_newline   ClearToQuery();_newline   SetViewMode(AllView);_newline   SetSearchSpec(&quot;CAF Id&quot;,gvCAFId); _newline   ExecuteQuery(ForwardOnly);_newline   var IsRec = FirstRecord();_newline   if(IsRec)_newline   {_newline    var vMasterId = GetFieldValue(&quot;Id&quot;);_newline    var vReqRefId = GetFieldValue(&quot;Request Reference Id&quot;);_newline    Outputs.SetProperty(&quot;MasterId&quot;,vMasterId);_newline    Outputs.SetProperty(&quot;ReqRefId&quot;,vReqRefId);_newline    Outputs.SetProperty(&quot;Circle&quot;, GetFieldValue(&quot;Circle Name&quot;));_newline    Outputs.SetProperty(&quot;Circle_usID&quot;, GetFieldValue(&quot;Circle_usID&quot;));_newline    Outputs.SetProperty(&quot;GEN_usCODE&quot;, GetFieldValue(&quot;Enterprise Code&quot;));_newline    with(vCAFAccBc)_newline    {_newline     ActivateField(&quot;Parent Id&quot;);_newline     ActivateField(&quot;Account Holder Name&quot;);_newline     ActivateField(&quot;Account Manager Name&quot;);_newline     ActivateField(&quot;Account Manager Email Id&quot;);_newline     ActivateField(&quot;Account Manager Number&quot;);_newline     ActivateField(&quot;Customer Type&quot;);_newline     ActivateField(&quot;Account Details Type&quot;);_newline     ActivateField(&quot;Customer Class&quot;);_newline     ActivateField(&quot;Customer Sub Type&quot;);_newline     ActivateField(&quot;Segment&quot;);_newline     ActivateField(&quot;TM Enterprise Code&quot;);_newline     ActivateField(&quot;Account Holder Name&quot;);_newline     ActivateField(&quot;Bill Cycle&quot;);_newline     ActivateField(&quot;Credit Limit Type&quot;);_newline     ActivateField(&quot;Credit Status Code&quot;);_newline     ActivateField(&quot;Credit Limit&quot;);_newline     ActivateField(&quot;Credit Score&quot;);_newline     ActivateField(&quot;Credit Status&quot;);_newline     ActivateField(&quot;Bill Frequency&quot;);_newline     ActivateField(&quot;Bill Language&quot;);_newline     ActivateField(&quot;Bill Media&quot;);_newline     ActivateField(&quot;Bill Type&quot;);_newline     ActivateField(&quot;Registered Email Id&quot;);_newline     ActivateField(&quot;Payment Method&quot;);_newline     ActivateField(&quot;Payment Type&quot;);_newline     ActivateField(&quot;Bank Account Number&quot;);_newline     ActivateField(&quot;Bank Name&quot;);_newline     ActivateField(&quot;Bank Branch&quot;);_newline     ActivateField(&quot;Bank Zip Code&quot;);_newline     ActivateField(&quot;Bank Account Holder Name&quot;);_newline     ActivateField(&quot;Card Number&quot;);_newline     ActivateField(&quot;Card Type for Payment Profile&quot;);_newline     ActivateField(&quot;Expiration Month&quot;);_newline     ActivateField(&quot;Expiration Year&quot;);_newline     ActivateField(&quot;Bank Account Type&quot;);_newline     ActivateField(&quot;Account Row Id&quot;);_newline     //ActivateField(&quot;Master Account Id&quot;);_newline     ActivateField(&quot;External Account Id&quot;);_newline     ActivateField(&quot;Industry&quot;);_newline     //ActivateField(&quot;OU Id&quot;);_newline     ActivateField(&quot;Parent External Account Id&quot;);_newline     ActivateField(&quot;Relationship Manager Number&quot;);_newline     ActivateField(&quot;Relationship Manager Name&quot;);_newline     ActivateField(&quot;Relationship Manager Email Id&quot;);_newline     ActivateField(&quot;Alternate Email Id&quot;);_newline     ActivateField(&quot;Area Id&quot;);_newline     ActivateField(&quot;Is Tax Exempted&quot;);_newline     ActivateField(&quot;Request Reference Id&quot;);_newline     ActivateField(&quot;Error Message&quot;);_newline     ActivateField(&quot;Parent External Account Id&quot;);_newline     ActivateField(&quot;Delivery Mode&quot;); //20161123: RAHUL: To store Delivery Mode_newline     //To store the fields required for Cust Account creation_newline     SetViewMode(AllView);_newline     ClearToQuery();_newline     //SetSearchSpec(&quot;Parent Id&quot;,vMasterId);_newline     //SetSearchSpec(&quot;Account Details Type&quot;,&quot;CustomerAccount&quot;);_newline     searchst = &quot;[Parent Id] = &apos;&quot;+vMasterId+&quot;&apos;  AND ([Account Details Type] = &apos;CustomerAccount&apos; OR [Account Details Type] = &apos;CustomerAccountAddOn&apos;)&quot;;_newline     SetSearchExpr(searchst);_newline     ExecuteQuery(ForwardOnly);_newline_newline     var IsCustAcc = FirstRecord();_newline     if(IsCustAcc)_newline     {_newline      Outputs.SetProperty(&quot;CA_usCustType&quot;,GetFieldValue(&quot;Customer Type&quot;));_newline      Outputs.SetProperty(&quot;CA_usCustSubType&quot;,GetFieldValue(&quot;Customer Sub Type&quot;));_newline      Outputs.SetProperty(&quot;CA_usCustSegment&quot;,GetFieldValue(&quot;Segment&quot;));_newline     // Outputs.SetProperty(&quot;CA_usGenCode&quot;,GetFieldValue(&quot;TM Enterprise Code&quot;));_newline      Outputs.SetProperty(&quot;CA_usAccName&quot;,GetFieldValue(&quot;Account Holder Name&quot;));_newline      Outputs.SetProperty(&quot;BillCycle&quot;,GetFieldValue(&quot;Bill Cycle&quot;));_newline      Outputs.SetProperty(&quot;CA_usId&quot;,GetFieldValue(&quot;External Account Id&quot;));_newline      Outputs.SetProperty(&quot;CA_usIndustry&quot;,GetFieldValue(&quot;Industry&quot;));_newline      //Outputs.SetProperty(&quot;OU_usId&quot;,GetFieldValue(&quot;OU Id&quot;));_newline      fun_usCreateCA(Inputs, Outputs);_newline      SetFieldValue(&quot;Account Row Id&quot;,Outputs.GetProperty(&quot;CAccId&quot;));_newline      SetFieldValue(&quot;Error Message&quot;,Outputs.GetProperty(&quot;ErrMsg&quot;));_newline      WriteRecord();              _newline     }_newline    //To store the fields required for Billing Account creation_newline     SetViewMode(AllView);_newline     ClearToQuery();_newline     //SetSearchSpec(&quot;Parent Id&quot;,vMasterId);_newline     //SetSearchSpec(&quot;Account Details Type&quot;,&quot;BillingAccount&quot;);_newline  searchst = &quot;[Parent Id] = &apos;&quot;+vMasterId+&quot;&apos;  AND ([Account Details Type] = &apos;BillingAccount&apos; OR [Account Details Type] = &apos;BillingAccountAddOn&apos;)&quot;;_newline     SetSearchExpr(searchst);_newline  ExecuteQuery(ForwardOnly);_newline     var IsBillAcc = FirstRecord();_newline     if(IsBillAcc)_newline     {_newline      Outputs.SetProperty(&quot;BA_usCustType&quot;,GetFieldValue(&quot;Customer Type&quot;));_newline      Outputs.SetProperty(&quot;BA_usCustSubType&quot;,GetFieldValue(&quot;Customer Sub Type&quot;));_newline      Outputs.SetProperty(&quot;BA_usCustSegment&quot;,GetFieldValue(&quot;Segment&quot;));_newline     // Outputs.SetProperty(&quot;BA_usEntCode&quot;,GetFieldValue(&quot;TM Enterprise Code&quot;));_newline      Outputs.SetProperty(&quot;BA_usAccName&quot;,GetFieldValue(&quot;Account Holder Name&quot;));_newline      Outputs.SetProperty(&quot;CreditLimit&quot;,GetFieldValue(&quot;Credit Limit&quot;));_newline      Outputs.SetProperty(&quot;CreditScore&quot;,GetFieldValue(&quot;Credit Score&quot;));_newline      Outputs.SetProperty(&quot;CreditStatus&quot;,GetFieldValue(&quot;Credit Status&quot;));_newline      Outputs.SetProperty(&quot;FA_usId&quot;,GetFieldValue(&quot;External Account Id&quot;));_newline      Outputs.SetProperty(&quot;ExtParentAccId&quot;,GetFieldValue(&quot;Parent External Account Id&quot;));_newline      fun_usCreateBA(Inputs, Outputs);_newline      SetFieldValue(&quot;Account Row Id&quot;,Outputs.GetProperty(&quot;BillAccId&quot;));_newline      SetFieldValue(&quot;Error Message&quot;,Outputs.GetProperty(&quot;ErrMsg&quot;));_newline      WriteRecord();_newline     }_newline  //To store the fields required for Sub Account creation_newline  SetViewMode(AllView);_newline     ClearToQuery();_newline     //SetSearchSpec(&quot;Parent Id&quot;,vMasterId);_newline     //SetSearchSpec(&quot;Account Details Type&quot;,&quot;SubAccount&quot;);_newline  searchst = &quot;[Parent Id] = &apos;&quot;+vMasterId+&quot;&apos;  AND ([Account Details Type] = &apos;SubAccount&apos; OR [Account Details Type] = &apos;SubAccountAddOn&apos;)&quot;;_newline     SetSearchExpr(searchst);_newline_newline     ExecuteQuery(ForwardOnly);_newline     IsSubAcc = FirstRecord();_newline     if(IsSubAcc)_newline     {_newline      Outputs.SetProperty(&quot;SA_usCustType&quot;,GetFieldValue(&quot;Customer Type&quot;));_newline      Outputs.SetProperty(&quot;SA_usCustSubType&quot;,GetFieldValue(&quot;Customer Sub Type&quot;));_newline      Outputs.SetProperty(&quot;SA_usCustSegment&quot;,GetFieldValue(&quot;Segment&quot;));_newline    //  Outputs.SetProperty(&quot;SA_usEntCode&quot;,GetFieldValue(&quot;TM Enterprise Code&quot;));_newline      Outputs.SetProperty(&quot;SA_usAccName&quot;,GetFieldValue(&quot;Account Holder Name&quot;));_newline      Outputs.SetProperty(&quot;OU_usId&quot;,GetFieldValue(&quot;External Account Id&quot;));_newline      Outputs.SetProperty(&quot;ExtParentAccId&quot;,GetFieldValue(&quot;Parent External Account Id&quot;));_newline      fun_usCreateSA(Inputs, Outputs);_newline      SetFieldValue(&quot;Account Row Id&quot;,Outputs.GetProperty(&quot;SAccId&quot;));_newline      SetFieldValue(&quot;Error Message&quot;,Outputs.GetProperty(&quot;ErrMsg&quot;));_newline      WriteRecord();_newline  }_newline_newline    //To store the fields required for Bill Profile creation_newline     SetViewMode(AllView);_newline     ClearToQuery();_newline     //SetSearchSpec(&quot;Parent Id&quot;,vMasterId);_newline     //SetSearchSpec(&quot;Account Details Type&quot;,&quot;BillingProfile-BA&quot;);_newline     searchst = &quot;[Parent Id] = &apos;&quot;+vMasterId+&quot;&apos;  AND ([Account Details Type] = &apos;BillingProfile-BA&apos; OR [Account Details Type] = &apos;BillingProfile-BAAddOn&apos;)&quot;;_newline     SetSearchExpr(searchst);_newline     ExecuteQuery(ForwardOnly);_newline     var IsBillProf = FirstRecord();_newline     if(IsBillProf)_newline     {_newline      Outputs.SetProperty(&quot;BillFreq&quot;,GetFieldValue(&quot;Bill Frequency&quot;));_newline      Outputs.SetProperty(&quot;BillLang&quot;,GetFieldValue(&quot;Bill Language&quot;));_newline      Outputs.SetProperty(&quot;BillMedia&quot;,GetFieldValue(&quot;Bill Media&quot;));_newline      Outputs.SetProperty(&quot;BillType&quot;,GetFieldValue(&quot;Bill Type&quot;));_newline      Outputs.SetProperty(&quot;RegEmail&quot;,GetFieldValue(&quot;Registered Email Id&quot;));_newline      Outputs.SetProperty(&quot;PaymentMethod&quot;,GetFieldValue(&quot;Payment Method&quot;));_newline      Outputs.SetProperty(&quot;PaymentType&quot;,GetFieldValue(&quot;Payment Type&quot;));_newline      Outputs.SetProperty(&quot;BA_usId&quot;,GetFieldValue(&quot;External Account Id&quot;));_newline      Outputs.SetProperty(&quot;BA_usDeliveryMode&quot;, GetFieldValue(&quot;Delivery Mode&quot;)); //20161123: RAHUL: To store Delivery Mode_newline      SetFieldValue(&quot;Error Message&quot;,Outputs.GetProperty(&quot;ErrMsg&quot;));_newline      //WriteRecord();_newline     }_newline     //To store the fields required for Payment Profile creation_newline     SetViewMode(AllView);_newline     ClearToQuery();_newline     //SetSearchSpec(&quot;Parent Id&quot;,vMasterId);_newline     //SetSearchSpec(&quot;Account Details Type&quot;,&quot;BillingProfile-PCN&quot;);_newline  searchst = &quot;[Parent Id] = &apos;&quot;+vMasterId+&quot;&apos;  AND ([Account Details Type] = &apos;BillingProfile-PCN&apos; OR [Account Details Type] = &apos;BillingProfile-PCNAddOn&apos;)&quot;;_newline     SetSearchExpr(searchst);_newline     ExecuteQuery(ForwardOnly);_newline     var IsPayProf = FirstRecord();_newline     if(IsPayProf)_newline     {_newline      Outputs.SetProperty(&quot;BankAccNum&quot;,GetFieldValue(&quot;Bank Account Number&quot;));_newline      Outputs.SetProperty(&quot;BankName&quot;,GetFieldValue(&quot;Bank Name&quot;));_newline      Outputs.SetProperty(&quot;BankBranch&quot;,GetFieldValue(&quot;Bank Branch&quot;));_newline      Outputs.SetProperty(&quot;BankAddPIN&quot;,GetFieldValue(&quot;Bank Zip Code&quot;));_newline      Outputs.SetProperty(&quot;CardHolder&quot;,GetFieldValue(&quot;Bank Account Holder Name&quot;));_newline      Outputs.SetProperty(&quot;CardNum&quot;,GetFieldValue(&quot;Card Number&quot;));_newline      Outputs.SetProperty(&quot;CardType&quot;,GetFieldValue(&quot;Card Type for Payment Profile&quot;));_newline      Outputs.SetProperty(&quot;CardExpMnth&quot;,GetFieldValue(&quot;Expiration Month&quot;));_newline      Outputs.SetProperty(&quot;CardExpYr&quot;,GetFieldValue(&quot;Expiration Year&quot;));_newline      Outputs.SetProperty(&quot;Type&quot;,GetFieldValue(&quot;Bank Account Type&quot;));_newline      Outputs.SetProperty(&quot;PCNId&quot;,GetFieldValue(&quot;External Account Id&quot;));_newline      Outputs.SetProperty(&quot;PCN_usDeliveryMode&quot;, GetFieldValue(&quot;Delivery Mode&quot;)); //20161123: RAHUL: To store Delivery Mode_newline      SetFieldValue(&quot;Error Message&quot;,Outputs.GetProperty(&quot;ErrMsg&quot;));_newline      //WriteRecord();_newline     }_newline    }_newline   SetFieldValue(&quot;TM Siebel Cust Account Id&quot;,Outputs.GetProperty(&quot;CAccId&quot;));_newline   WriteRecord();_newline   }_newline   // Update in CAF Master_newline   //SetFieldValue(&quot;TM Siebel Cust Account Id&quot;,Outputs.GetProperty(&quot;CAccId&quot;));_newline   //SetFieldValue(&quot;Billing Account Row Id&quot;,Outputs.GetProperty(&quot;BillAccId&quot;));_newline   //WriteRecord();_newline  } _newline  return(CancelOperation);_newline }_newline catch(e)_newline {_newline  TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure&apos;,&apos;fun_usReadCAFAccount&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline  throw e;_newline }_newline finally_newline {_newline  vCAFAccBc=null;_newline  vCAFMstrBc=null;_newline  vCAFBo=null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="fun_usReadCAFAccount"
 Sequence="13"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments="20161111:RAHUL: QC#5168: Area Id stored at Address Level"
 Parent_spcId="1-HMVV9M"
 Parent_spcName="TM Create Customer BS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="//Your public declarations go here..._newline_newlinefunction fun_usReadCAFAddr(Inputs,Outputs)_newline{_newline var vCAFBo = TheApplication().GetBusObject(&quot;TM CAF Details BO&quot;);_newlinevar vCAFMstBc = vCAFBo.GetBusComp(&quot;TM CAF Master BC&quot;);_newline var vCAFAddBc = vCAFBo.GetBusComp(&quot;TM CAF Address BC&quot;);_newlinevar vMasterId = Outputs.GetProperty(&quot;MasterId&quot;);_newline var vAddrType,IsAdd;_newline try_newline { _newline   vCAFMstBc.SetViewMode(AllView);_newline    vCAFMstBc.ClearToQuery();_newline    vCAFMstBc.SetSearchExpr(&quot;[Id] = &apos;&quot; + vMasterId +&quot;&apos;&quot;);_newline    vCAFMstBc.ExecuteQuery(ForwardOnly);_newline    if (vCAFMstBc.FirstRecord())_newline    {_newline  with(vCAFAddBc)_newline  {_newline   ActivateField(&quot;Parent Id&quot;);_newline   ActivateField(&quot;Address Line 1&quot;);_newline   ActivateField(&quot;Address Line 2&quot;);_newline   ActivateField(&quot;Address Line 3&quot;);_newline   ActivateField(&quot;Landmark&quot;);_newline   ActivateField(&quot;City&quot;);_newline   ActivateField(&quot;State&quot;);_newline   ActivateField(&quot;Country&quot;);_newline   ActivateField(&quot;Zip Code&quot;);_newline   ActivateField(&quot;Address Type&quot;);_newline   ActivateField(&quot;Address Proof Type&quot;);_newline   ActivateField(&quot;Address Document Number&quot;);_newline   ActivateField(&quot;Address Issuing Authority&quot;);_newline   ActivateField(&quot;Proof of Address Place of Issue&quot;);_newline   ActivateField(&quot;Cost Center Code&quot;);_newline   ActivateField(&quot;Cost Center Name&quot;);_newline   ActivateField(&quot;Request Reference Id&quot;);_newline   ActivateField(&quot;Address Date of Issue&quot;);_newline   ActivateField(&quot;Address Id&quot;);_newline   ActivateField(&quot;TM Address Link Type&quot;);_newline   ActivateField(&quot;Area Id&quot;); //20161111: RAHUL: To store Area Id for QC#5168_newline   ActivateField(&quot;Error Message&quot;);_newline_newline   SetViewMode(AllView);_newline   ClearToQuery();_newline   SetSearchSpec(&quot;Parent Id&quot;,vMasterId);_newline   //SetSearchSpec(&quot;TM CAF Id&quot;,Outputs.GetProperty(&quot;CAFId&quot;));_newline   //SetSearchSpec(&quot;Parent Id&quot;,&quot;1S-V3H&quot;);_newline   SetSearchSpec(&quot;Entity Type&quot;,&quot;Address&quot;);_newline   ExecuteQuery(ForwardOnly);_newline   IsAdd = FirstRecord();_newline   while(IsAdd)_newline   {_newline    Outputs.SetProperty(&quot;AddrLine1&quot;,GetFieldValue(&quot;Address Line 1&quot;));_newline    Outputs.SetProperty(&quot;AddrLine2&quot;,GetFieldValue(&quot;Address Line 2&quot;));_newline    Outputs.SetProperty(&quot;AddrLine3&quot;,GetFieldValue(&quot;Address Line 3&quot;));_newline    Outputs.SetProperty(&quot;Landmark&quot;,GetFieldValue(&quot;Landmark&quot;));_newline    Outputs.SetProperty(&quot;City&quot;,GetFieldValue(&quot;City&quot;));_newline    Outputs.SetProperty(&quot;State&quot;,GetFieldValue(&quot;State&quot;));_newline    Outputs.SetProperty(&quot;ZipCode&quot;,GetFieldValue(&quot;Zip Code&quot;));_newline    Outputs.SetProperty(&quot;Country&quot;,GetFieldValue(&quot;Country&quot;));_newline    Outputs.SetProperty(&quot;AddressType&quot;,GetFieldValue(&quot;Address Type&quot;));_newline    Outputs.SetProperty(&quot;POAType&quot;,GetFieldValue(&quot;Address Proof Type&quot;));_newline    Outputs.SetProperty(&quot;POANumber&quot;,GetFieldValue(&quot;Address Document Number&quot;));_newline    Outputs.SetProperty(&quot;POAIssueAuth&quot;,GetFieldValue(&quot;Address Issuing Authority&quot;));_newline    Outputs.SetProperty(&quot;POAIssuePlace&quot;,GetFieldValue(&quot;Proof of Address Place of Issue&quot;));_newline    Outputs.SetProperty(&quot;POAIssueDate&quot;,GetFieldValue(&quot;Address Date of Issue&quot;));_newline    Outputs.SetProperty(&quot;CostCenterCode&quot;,GetFieldValue(&quot;Cost Center Code&quot;));_newline    Outputs.SetProperty(&quot;AreaId&quot;,GetFieldValue(&quot;Area Id&quot;)); //20161111:RAHUL:To store Area Id for QC#5168_newline_newline    //gvAddrType = GetFieldValue(&quot;Address Type&quot;);_newline    fun_usCreateAddress(Inputs, Outputs);_newline    SetFieldValue(&quot;Address Id&quot;,Outputs.GetProperty(&quot;AddressId&quot;));_newline SetFieldValue(&quot;Error Message&quot;,Outputs.GetProperty(&quot;AddErrMsg&quot;));_newline    SetFieldValue(&quot;TM Address Link Type&quot;,Outputs.GetProperty(&quot;StreetAddress&quot;));_newline    WriteRecord();_newline    IsAdd = NextRecord();_newline   } _newline  }  _newline}_newline  return(CancelOperation);_newline }_newline catch(e)_newline {_newline  TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure&apos;,&apos;fun_usReadCAFAddr&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline  throw e;_newline }_newline finally_newline {_newline  vCAFAddBc=null;_newline  vCAFBo=null;_newline  //gvAddrType=null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="fun_usReadCAFAddr"
 Sequence="14"
></Business_spcService_spcScript
><Business_spcService_spcScript
 Comments=""
 Parent_spcId="1-HMVV9M"
 Parent_spcName="TM Create Customer BS"
 Parent_spcInactive="N"
 Inactive="N"
 Script="//20151216:RAHUL:This function will read the CAF table and pass the propertyset to create other Entities._newlinefunction fun_usReadCAFContact(Inputs,Outputs)_newline{_newline var vCAFBo = TheApplication().GetBusObject(&quot;TM CAF Details BO&quot;);_newline var vCAFMstBc = vCAFBo.GetBusComp(&quot;TM CAF Master BC&quot;);_newline var vCAFConBc = vCAFBo.GetBusComp(&quot;TM CAF Contact BC&quot;); _newline var vMasterId = Outputs.GetProperty(&quot;MasterId&quot;);_newline try_newline {   _newline    vCAFMstBc.SetViewMode(AllView);_newline    vCAFMstBc.ClearToQuery();_newline    vCAFMstBc.SetSearchExpr(&quot;[Id] = &apos;&quot; + vMasterId +&quot;&apos;&quot;);_newline    vCAFMstBc.ExecuteQuery(ForwardOnly);_newline    if (vCAFMstBc.FirstRecord())_newline    {_newline with(vCAFConBc)_newline  {_newline   ActivateField(&quot;Parent Id&quot;);_newline   ActivateField(&quot;First Name&quot;);_newline   ActivateField(&quot;Middle Name&quot;);_newline   ActivateField(&quot;Last Name&quot;);_newline   ActivateField(&quot;Employee Number&quot;);_newline   ActivateField(&quot;Employer Name&quot;);_newline   ActivateField(&quot;Email Address&quot;);_newline   ActivateField(&quot;Id Type&quot;);_newline   ActivateField(&quot;Id Number&quot;);_newline   ActivateField(&quot;Id Expiry&quot;);_newline   ActivateField(&quot;Birth Date&quot;);_newline   ActivateField(&quot;Salutation&quot;);_newline   ActivateField(&quot;Gender&quot;);_newline   ActivateField(&quot;Best Call Time&quot;);_newline   ActivateField(&quot;Alternate Contact Number&quot;);_newline   ActivateField(&quot;Alternate Email Id&quot;);_newline   ActivateField(&quot;Contact Number&quot;);_newline   ActivateField(&quot;Proof of Identity Date of Issue&quot;);_newline   ActivateField(&quot;Department&quot;);_newline   ActivateField(&quot;Fathers_usMothersMaiden Name&quot;);_newline   ActivateField(&quot;Designation&quot;);_newline   ActivateField(&quot;Hobby&quot;);_newline   ActivateField(&quot;Home Phone Number&quot;);_newline   ActivateField(&quot;eKYC&quot;);_newline   ActivateField(&quot;Job Title&quot;);_newline   ActivateField(&quot;Local Reference First Name&quot;);_newline   ActivateField(&quot;Local Reference Middle Name&quot;);_newline   ActivateField(&quot;Local Reference Last Name&quot;);_newline   ActivateField(&quot;Local Reference Contact Number&quot;);_newline   ActivateField(&quot;Local Reference Address&quot;);_newline   ActivateField(&quot;Local_usReference_usHotel Address&quot;);_newline   ActivateField(&quot;Local_usReference_usHotel_usName&quot;);_newline   ActivateField(&quot;Mobile Phone&quot;);_newline   ActivateField(&quot;Nationality&quot;);_newline   ActivateField(&quot;Proof of Identify Place of Issue&quot;);_newline   ActivateField(&quot;Port Stay Permit Date&quot;);_newline   ActivateField(&quot;Preferred Communications&quot;);_newline   ActivateField(&quot;Spoken Language&quot;);_newline   ActivateField(&quot;Written Language&quot;); //20170317:RAHUL_newline   ActivateField(&quot;Contact Type&quot;);_newline   ActivateField(&quot;Aadhar number&quot;);_newline   ActivateField(&quot;PAN Number&quot;);_newline   ActivateField(&quot;Passport_usNumber&quot;);_newline   ActivateField(&quot;POI Approval Authority&quot;);_newline   ActivateField(&quot;Visa Expiry&quot;);_newline   ActivateField(&quot;Visa Number&quot;);_newline   ActivateField(&quot;Subscriber Visa Type&quot;);//20160118:NIWASK:Added for DM12102_newline   ActivateField(&quot;Request Reference Id&quot;);_newline   //ActivateField(&quot;Name Link Type&quot;);_newline   ActivateField(&quot;Comment&quot;);_newline   ActivateField(&quot;Contact Id&quot;);_newline   ActivateField(&quot;TM CAF Id&quot;);_newline   ActivateField(&quot;Error Message&quot;);_newline   SetViewMode(AllView);_newline   ClearToQuery();_newline   SetSearchSpec(&quot;Parent Id&quot;,vMasterId);_newline   SetSearchSpec(&quot;Entity Type&quot;,&quot;Contact&quot;);_newline   ExecuteQuery(ForwardOnly);_newline   var IsContact = FirstRecord();_newline   while(IsContact)_newline   {_newline    Outputs.SetProperty(&quot;FirstName&quot;,GetFieldValue(&quot;First Name&quot;));_newline    Outputs.SetProperty(&quot;MiddleName&quot;,GetFieldValue(&quot;Middle Name&quot;));_newline    Outputs.SetProperty(&quot;LastName&quot;,GetFieldValue(&quot;Last Name&quot;));_newline    Outputs.SetProperty(&quot;Email&quot;,GetFieldValue(&quot;Email Address&quot;));_newline    Outputs.SetProperty(&quot;AltEmail&quot;,GetFieldValue(&quot;Alternate Email Id&quot;));_newline    Outputs.SetProperty(&quot;EmployeeNum&quot;,GetFieldValue(&quot;Employee Number&quot;));_newline    Outputs.SetProperty(&quot;EmployerName&quot;,GetFieldValue(&quot;Employer Name&quot;));_newline    Outputs.SetProperty(&quot;AltContNum&quot;,GetFieldValue(&quot;Alternate Contact Number&quot;));_newline    Outputs.SetProperty(&quot;POI_usType&quot;,GetFieldValue(&quot;Id Type&quot;));_newline    Outputs.SetProperty(&quot;POI_usNum&quot;,GetFieldValue(&quot;Id Number&quot;));_newline    Outputs.SetProperty(&quot;POI_usExpiry&quot;,GetFieldValue(&quot;Id Expiry&quot;));_newline    Outputs.SetProperty(&quot;POI_usIssue_usPlace&quot;,GetFieldValue(&quot;Proof of Identify Place of Issue&quot;));_newline    Outputs.SetProperty(&quot;POIApprvlAuth&quot;,GetFieldValue(&quot;POI Approval Authority&quot;));_newline    Outputs.SetProperty(&quot;BirthDate&quot;,GetFieldValue(&quot;Birth Date&quot;));_newline    Outputs.SetProperty(&quot;Salutation&quot;,GetFieldValue(&quot;Salutation&quot;));_newline    Outputs.SetProperty(&quot;Gender&quot;,GetFieldValue(&quot;Gender&quot;));_newline    Outputs.SetProperty(&quot;BestCallTime&quot;,GetFieldValue(&quot;Best Call Time&quot;));_newline    Outputs.SetProperty(&quot;ContactNum&quot;,GetFieldValue(&quot;Contact Number&quot;));_newline    Outputs.SetProperty(&quot;POI_usIssue_usDt&quot;,GetFieldValue(&quot;Proof of Identity Date of Issue&quot;));_newline    Outputs.SetProperty(&quot;Dept&quot;,GetFieldValue(&quot;Department&quot;));_newline    Outputs.SetProperty(&quot;FMMaidenName&quot;,GetFieldValue(&quot;Fathers_usMothersMaiden Name&quot;));_newline    Outputs.SetProperty(&quot;Dept&quot;,GetFieldValue(&quot;Department&quot;));_newline    Outputs.SetProperty(&quot;Desgn&quot;,GetFieldValue(&quot;Designation&quot;));_newline    Outputs.SetProperty(&quot;Hobby&quot;,GetFieldValue(&quot;Hobby&quot;));_newline    Outputs.SetProperty(&quot;HomePhnNum&quot;,GetFieldValue(&quot;Home Phone Number&quot;));_newline    Outputs.SetProperty(&quot;eKYC&quot;,GetFieldValue(&quot;eKYC&quot;));_newline    Outputs.SetProperty(&quot;JobTitle&quot;,GetFieldValue(&quot;Job Title&quot;));_newline    Outputs.SetProperty(&quot;LocalRefFName&quot;,GetFieldValue(&quot;Local Reference First Name&quot;));_newline    Outputs.SetProperty(&quot;LocalRefMName&quot;,GetFieldValue(&quot;Local Reference Middle Name&quot;));_newline    Outputs.SetProperty(&quot;LocalRefLName&quot;,GetFieldValue(&quot;Local Reference Last Name&quot;));_newline    Outputs.SetProperty(&quot;LocalRefConNum&quot;,GetFieldValue(&quot;Local Reference Contact Number&quot;));_newline    Outputs.SetProperty(&quot;LocalRefAdd&quot;,GetFieldValue(&quot;Local Reference Address&quot;));_newline    Outputs.SetProperty(&quot;LocalHotelAdd&quot;,GetFieldValue(&quot;Local_usReference_usHotel Address&quot;));_newline    Outputs.SetProperty(&quot;LocalHotelName&quot;,GetFieldValue(&quot;Local_usReference_usHotel_usName&quot;));_newline    Outputs.SetProperty(&quot;MobilePhone&quot;,GetFieldValue(&quot;Mobile Phone&quot;));_newline    Outputs.SetProperty(&quot;Nationality&quot;,GetFieldValue(&quot;Nationality&quot;));_newline    Outputs.SetProperty(&quot;PortStayPermtDt&quot;,GetFieldValue(&quot;Port Stay Permit Date&quot;));_newline    Outputs.SetProperty(&quot;PrefComm&quot;,GetFieldValue(&quot;Preferred Communications&quot;));_newline    Outputs.SetProperty(&quot;SpokenLang&quot;,GetFieldValue(&quot;Spoken Language&quot;));_newline Outputs.SetProperty(&quot;WrittenLang&quot;,GetFieldValue(&quot;Written Language&quot;)); //20170317:RAHUL_newline    Outputs.SetProperty(&quot;ContactRole&quot;,GetFieldValue(&quot;Contact Type&quot;));_newline    Outputs.SetProperty(&quot;AadharNum&quot;,GetFieldValue(&quot;Aadhar number&quot;));_newline    Outputs.SetProperty(&quot;PAN&quot;,GetFieldValue(&quot;PAN Number&quot;));_newline    Outputs.SetProperty(&quot;Passport&quot;,GetFieldValue(&quot;Passport_usNumber&quot;));_newline    Outputs.SetProperty(&quot;VISANum&quot;,GetFieldValue(&quot;Visa Number&quot;));_newline    Outputs.SetProperty(&quot;VISAExp&quot;,GetFieldValue(&quot;Visa Expiry&quot;));_newline    Outputs.SetProperty(&quot;VisaType&quot;,GetFieldValue(&quot;Subscriber Visa Type&quot;));//20160118:NIWASK:Added for DM12102_newline    Outputs.SetProperty(&quot;ReqRefId&quot;,GetFieldValue(&quot;Request Reference Id&quot;));_newline    //Outputs.SetProperty(&quot;NameLinkType&quot;,GetFieldValue(&quot;Name Link Type&quot;));_newline    Outputs.SetProperty(&quot;Comment&quot;,GetFieldValue(&quot;Comment&quot;));_newline    Outputs.SetProperty(&quot;ContactId&quot;,GetFieldValue(&quot;Contact Id&quot;));_newline_newline    fun_usCreateContact(Inputs,Outputs);_newline    SetFieldValue(&quot;Contact Id&quot;,Outputs.GetProperty(&quot;ContactId&quot;));_newline SetFieldValue(&quot;Error Message&quot;,Outputs.GetProperty(&quot;ContErrMsg&quot;));_newline    WriteRecord();_newline    IsContact = NextRecord();           _newline   } _newline  }_newline}_newline  return(CancelOperation);_newline }_newline catch(e)_newline {_newline  TheApplication().LogError(&apos;Script&apos;,e.errCode,e.errText,&apos;Code Failure&apos;,&apos;fun_usReadCAFContact&apos;,&apos;&apos;,&apos;TM Create Customer BS&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;,&apos;&apos;);_newline  throw e;_newline }_newline finally_newline {_newline  vCAFConBc=null;_newline  vCAFBo=null;_newline  //vCAFNum=null;_newline }_newline}"
 Program_spcLanguage="JS"
 Name="fun_usReadCAFContact"
 Sequence="15"
></Business_spcService_spcScript
></Business_spcService
>